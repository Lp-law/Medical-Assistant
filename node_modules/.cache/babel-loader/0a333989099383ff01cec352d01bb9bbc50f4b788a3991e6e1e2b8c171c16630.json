{"ast":null,"code":"import _objectSpread from\"C:/Office-Apps/LexMedical-App/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";export const API_BASE_URL=process.env.REACT_APP_API_BASE_URL||'http://localhost:4000/api';let authToken=null;export const setAuthToken=token=>{authToken=token;};const withAuth=init=>{const headers=new Headers((init===null||init===void 0?void 0:init.headers)||{});if(authToken){headers.set('Authorization',\"Bearer \".concat(authToken));}return _objectSpread(_objectSpread({},init),{},{headers});};const request=async(path,init)=>{const response=await fetch(\"\".concat(API_BASE_URL).concat(path),withAuth(init));if(!response.ok){const errorText=await response.text().catch(()=>'');throw new Error(errorText||'request_failed');}if(response.status===204){return undefined;}return await response.json();};export{request as apiRequest};export const isApiConfigured=()=>Boolean(API_BASE_URL);export const uploadChapterPdf=async function(file){var _options$docType,_options$tags;let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const formData=new FormData();formData.append('file',file);formData.append('docType',(_options$docType=options.docType)!==null&&_options$docType!==void 0?_options$docType:'chapter');if((_options$tags=options.tags)!==null&&_options$tags!==void 0&&_options$tags.length){formData.append('tags',options.tags.join(','));}if(options.metadata){formData.append('metadata',JSON.stringify(options.metadata));}const response=await fetch(\"\".concat(API_BASE_URL,\"/ingest/pdf\"),withAuth({method:'POST',body:formData}));if(!response.ok){const errorText=await response.text();throw new Error(errorText||'api-upload-failed');}const data=await response.json();return data;};export const listCases=async()=>{var _payload$cases;const payload=await request('/cases',{method:'GET'});return(_payload$cases=payload.cases)!==null&&_payload$cases!==void 0?_payload$cases:[];};export const createCase=async data=>{const payload=await request('/cases',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});return payload.case;};export const getCase=async id=>{const payload=await request(\"/cases/\".concat(id),{method:'GET'});return payload.case;};export const updateCase=async(id,data)=>{const payload=await request(\"/cases/\".concat(id),{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});return payload.case;};export const deleteCase=async id=>{await request(\"/cases/\".concat(id),{method:'DELETE'});};","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_BASE_URL","authToken","setAuthToken","token","withAuth","init","headers","Headers","set","concat","_objectSpread","request","path","response","fetch","ok","errorText","text","catch","Error","status","undefined","json","apiRequest","isApiConfigured","Boolean","uploadChapterPdf","file","_options$docType","_options$tags","options","arguments","length","formData","FormData","append","docType","tags","join","metadata","JSON","stringify","method","body","data","listCases","_payload$cases","payload","cases","createCase","case","getCase","id","updateCase","deleteCase"],"sources":["C:/Office-Apps/LexMedical-App/src/services/api.ts"],"sourcesContent":["import { CaseData, IngestedDocument } from '../types';\r\n\r\nexport const API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:4000/api';\r\n\r\ninterface UploadChapterOptions {\r\n  docType?: 'chapter' | 'precedent';\r\n  tags?: string[];\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nlet authToken: string | null = null;\r\n\r\nexport const setAuthToken = (token: string | null): void => {\r\n  authToken = token;\r\n};\r\n\r\nconst withAuth = (init?: RequestInit): RequestInit => {\r\n  const headers = new Headers(init?.headers || {});\r\n  if (authToken) {\r\n    headers.set('Authorization', `Bearer ${authToken}`);\r\n  }\r\n  return {\r\n    ...init,\r\n    headers,\r\n  };\r\n};\r\n\r\nconst request = async <T>(path: string, init?: RequestInit): Promise<T> => {\r\n  const response = await fetch(`${API_BASE_URL}${path}`, withAuth(init));\r\n  if (!response.ok) {\r\n    const errorText = await response.text().catch(() => '');\r\n    throw new Error(errorText || 'request_failed');\r\n  }\r\n  if (response.status === 204) {\r\n    return undefined as T;\r\n  }\r\n  return (await response.json()) as T;\r\n};\r\n\r\nexport { request as apiRequest };\r\n\r\nexport const isApiConfigured = (): boolean => Boolean(API_BASE_URL);\r\n\r\nexport const uploadChapterPdf = async (file: File, options: UploadChapterOptions = {}): Promise<IngestedDocument> => {\r\n  const formData = new FormData();\r\n  formData.append('file', file);\r\n  formData.append('docType', options.docType ?? 'chapter');\r\n  if (options.tags?.length) {\r\n    formData.append('tags', options.tags.join(','));\r\n  }\r\n  if (options.metadata) {\r\n    formData.append('metadata', JSON.stringify(options.metadata));\r\n  }\r\n\r\n  const response = await fetch(`${API_BASE_URL}/ingest/pdf`, withAuth({ method: 'POST', body: formData }));\r\n\r\n  if (!response.ok) {\r\n    const errorText = await response.text();\r\n    throw new Error(errorText || 'api-upload-failed');\r\n  }\r\n\r\n  const data = (await response.json()) as IngestedDocument;\r\n  return data;\r\n};\r\n\r\nexport interface CaseRecord {\r\n  id: string;\r\n  title: string;\r\n  data: CaseData;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport const listCases = async (): Promise<CaseRecord[]> => {\r\n  const payload = await request<{ cases: CaseRecord[] }>('/cases', { method: 'GET' });\r\n  return payload.cases ?? [];\r\n};\r\n\r\nexport const createCase = async (data: { title: string; data: CaseData }): Promise<CaseRecord> => {\r\n  const payload = await request<{ case: CaseRecord }>('/cases', {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  return payload.case;\r\n};\r\n\r\nexport const getCase = async (id: string): Promise<CaseRecord> => {\r\n  const payload = await request<{ case: CaseRecord }>(`/cases/${id}`, { method: 'GET' });\r\n  return payload.case;\r\n};\r\n\r\nexport const updateCase = async (\r\n  id: string,\r\n  data: { title?: string; data?: CaseData },\r\n): Promise<CaseRecord> => {\r\n  const payload = await request<{ case: CaseRecord }>(`/cases/${id}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  return payload.case;\r\n};\r\n\r\nexport const deleteCase = async (id: string): Promise<void> => {\r\n  await request<void>(`/cases/${id}`, { method: 'DELETE' });\r\n};\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}