{"ast":null,"code":"var _jsxFileName = \"C:\\\\Office-Apps\\\\LexMedical-App\\\\src\\\\App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useAuth } from './context/AuthContext';\nimport { createCase as apiCreateCase, listCases as apiListCases, updateCase as apiUpdateCase } from './services/api';\nimport LoginScreen from './components/LoginScreen';\nimport AdminDashboard from './components/AdminDashboard';\nimport LiabilityStep from './components/LiabilityStep';\nimport DamagesStep from './components/DamagesStep';\nimport ReasoningStep from './components/ReasoningStep';\nimport ReportStep from './components/ReportStep';\nimport CaseDashboard from './components/CaseDashboard';\nimport { FolderOpen, ChevronLeft, Shield, Activity, UploadCloud, FileText, LogOut, LayoutDashboard, BookOpen, Download, Upload, Home } from 'lucide-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst createEmptyCase = attorney => ({\n  id: Date.now().toString(),\n  name: 'תיק חדש ' + new Date().toLocaleDateString('he-IL'),\n  attorney,\n  lastUpdated: new Date().toISOString(),\n  summary: '',\n  summaryFiles: [],\n  liability: {\n    issues: [],\n    medicalRecordQuality: 'Complete',\n    doctrines: [],\n    precedents: [],\n    expertsPlaintiff: [],\n    expertsDefense: [],\n    expertCourtOpinions: [],\n    expertCourtStance: 'None',\n    aggravatingFactors: 2,\n    mitigatingFactors: 2,\n    probability: 50,\n    probabilityRange: [40, 60],\n    uncertainty: 'Medium',\n    strengthsPlaintiff: [''],\n    weaknessesPlaintiff: [''],\n    strengthsDefense: [''],\n    weaknessesDefense: ['']\n  },\n  damages: {\n    dateOfBirth: '1990-01-01',\n    gender: 'Male',\n    dateOfEvent: new Date(new Date().setFullYear(new Date().getFullYear() - 2)).toISOString().split('T')[0],\n    dateOfCalc: new Date().toISOString().split('T')[0],\n    dateOfRetirement: '',\n    ageAtInjury: 0,\n    currentAge: 0,\n    lifeExpectancy: 82,\n    wagePreInjury: 10000,\n    wagePostInjury: 0,\n    permanentDisabilityMedical: 10,\n    permanentDisabilityFunctional: 10,\n    daysOfHospitalization: 0,\n    interestRate: 3,\n    heads: [{\n      id: '1',\n      name: 'הפסד שכר לעבר',\n      isActive: true,\n      parameters: {},\n      calculatedAmount: 0,\n      notes: ''\n    }, {\n      id: '2',\n      name: 'הפסד שכר לעתיד',\n      isActive: true,\n      parameters: {},\n      calculatedAmount: 0,\n      notes: ''\n    }, {\n      id: '3',\n      name: 'הפסד פנסיה ותנאים סוציאליים',\n      isActive: true,\n      parameters: {},\n      calculatedAmount: 0,\n      notes: ''\n    }, {\n      id: '4',\n      name: 'כאב וסבל',\n      isActive: true,\n      parameters: {},\n      calculatedAmount: 0,\n      notes: ''\n    }, {\n      id: '5',\n      name: 'עזרת צד ג׳ לעבר',\n      isActive: false,\n      parameters: {},\n      calculatedAmount: 0,\n      notes: ''\n    }, {\n      id: '6',\n      name: 'עזרת צד ג׳ לעתיד',\n      isActive: false,\n      parameters: {},\n      calculatedAmount: 0,\n      notes: ''\n    }, {\n      id: '7',\n      name: 'הוצאות רפואיות',\n      isActive: false,\n      parameters: {},\n      calculatedAmount: 0,\n      notes: ''\n    }, {\n      id: '8',\n      name: 'ניידות ונסיעות',\n      isActive: false,\n      parameters: {},\n      calculatedAmount: 0,\n      notes: ''\n    }],\n    precedents: []\n  }\n});\nconst App = () => {\n  _s();\n  const {\n    user,\n    logout\n  } = useAuth();\n  const [activeStep, setActiveStep] = useState(0);\n  const [showAdminDashboard, setShowAdminDashboard] = useState(false);\n  const [, setCaseList] = useState([]);\n  const [currentCaseId, setCurrentCaseId] = useState(null);\n  const [currentCase, setCurrentCase] = useState(null);\n  const [saveStatus, setSaveStatus] = useState('idle');\n  const [isLoadingCases, setIsLoadingCases] = useState(false);\n  const [loadError, setLoadError] = useState(null);\n  const fileInputRef = useRef(null);\n  const saveTimeoutRef = useRef(null);\n  const resetStatusTimeoutRef = useRef(null);\n  const hydratingRef = useRef(false);\n  const isAdmin = (user === null || user === void 0 ? void 0 : user.role) === 'admin';\n  const cleanupClientState = () => {\n    setCaseList([]);\n    setCurrentCaseId(null);\n    setCurrentCase(null);\n    setShowAdminDashboard(false);\n    setActiveStep(0);\n    setSaveStatus('idle');\n    if (saveTimeoutRef.current) {\n      clearTimeout(saveTimeoutRef.current);\n      saveTimeoutRef.current = null;\n    }\n    if (resetStatusTimeoutRef.current) {\n      clearTimeout(resetStatusTimeoutRef.current);\n      resetStatusTimeoutRef.current = null;\n    }\n  };\n  const normalizeCaseData = (record, attorneyFallback) => {\n    const safeData = record.data || createEmptyCase(attorneyFallback);\n    return {\n      ...createEmptyCase(attorneyFallback),\n      ...safeData,\n      id: record.id,\n      name: safeData.name || record.title || `תיק ${new Date().toLocaleDateString('he-IL')}`,\n      attorney: safeData.attorney || attorneyFallback\n    };\n  };\n  const handleCreateNewCase = useCallback(async attorneyName => {\n    if (!user) return;\n    setIsLoadingCases(true);\n    setLoadError(null);\n    try {\n      const template = createEmptyCase(attorneyName);\n      const created = await apiCreateCase({\n        title: template.name,\n        data: template\n      });\n      setCaseList(prev => [created, ...prev]);\n      const normalized = {\n        ...template,\n        id: created.id\n      };\n      setCurrentCaseId(created.id);\n      hydratingRef.current = true;\n      setCurrentCase(normalized);\n      setActiveStep(0);\n    } catch (error) {\n      console.error(error);\n      setLoadError('יצירת תיק חדש נכשלה.');\n    } finally {\n      setIsLoadingCases(false);\n    }\n  }, [user]);\n  useEffect(() => {\n    let cancelled = false;\n    const bootstrap = async () => {\n      if (!user) {\n        cleanupClientState();\n        return;\n      }\n      setIsLoadingCases(true);\n      setLoadError(null);\n      try {\n        const cases = await apiListCases();\n        if (cancelled) return;\n        setCaseList(cases);\n        setShowAdminDashboard(isAdmin);\n        if (!cases.length) {\n          await handleCreateNewCase(user.username);\n          return;\n        }\n        const sorted = [...cases].sort((a, b) => new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime());\n        const primary = sorted[0];\n        setCurrentCaseId(primary.id);\n        hydratingRef.current = true;\n        setCurrentCase(normalizeCaseData(primary, user.username));\n        setActiveStep(0);\n      } catch (error) {\n        console.error(error);\n        if (!cancelled) {\n          setLoadError('טעינת התיקים נכשלה. נסה שוב בעוד רגע.');\n        }\n      } finally {\n        if (!cancelled) {\n          setIsLoadingCases(false);\n        }\n      }\n    };\n    bootstrap();\n    return () => {\n      cancelled = true;\n    };\n  }, [user, isAdmin, handleCreateNewCase]);\n  const handleLogout = () => {\n    logout();\n    cleanupClientState();\n  };\n  const handleAdminEditCase = caseData => {\n    setCurrentCaseId(caseData.id);\n    hydratingRef.current = true;\n    setCurrentCase(caseData);\n    setShowAdminDashboard(false);\n    setActiveStep(0);\n  };\n  useEffect(() => {\n    if (!user || !currentCaseId || !currentCase || showAdminDashboard) return;\n    if (hydratingRef.current) {\n      hydratingRef.current = false;\n      return;\n    }\n    if (saveTimeoutRef.current) {\n      clearTimeout(saveTimeoutRef.current);\n    }\n    setSaveStatus('saving');\n    saveTimeoutRef.current = setTimeout(async () => {\n      try {\n        const updated = await apiUpdateCase(currentCaseId, {\n          title: currentCase.name,\n          data: currentCase\n        });\n        setCaseList(prev => {\n          const filtered = prev.filter(c => c.id !== updated.id);\n          return [updated, ...filtered];\n        });\n        setSaveStatus('saved');\n        if (resetStatusTimeoutRef.current) {\n          clearTimeout(resetStatusTimeoutRef.current);\n        }\n        resetStatusTimeoutRef.current = setTimeout(() => setSaveStatus('idle'), 1500);\n      } catch (error) {\n        console.error(error);\n        setSaveStatus('error');\n      }\n    }, 1200);\n    return () => {\n      if (saveTimeoutRef.current) {\n        clearTimeout(saveTimeoutRef.current);\n        saveTimeoutRef.current = null;\n      }\n    };\n  }, [currentCase, currentCaseId, user, showAdminDashboard]);\n  const handleSummaryFileUpload = e => {\n    if (e.target.files && e.target.files[0] && currentCase) {\n      const file = e.target.files[0];\n      const newFile = {\n        name: file.name,\n        size: file.size,\n        type: file.type,\n        lastModified: file.lastModified\n      };\n      setCurrentCase({\n        ...currentCase,\n        summaryFiles: [...(currentCase.summaryFiles || []), newFile]\n      });\n    }\n  };\n  const removeSummaryFile = fileName => {\n    if (currentCase) {\n      setCurrentCase({\n        ...currentCase,\n        summaryFiles: currentCase.summaryFiles.filter(f => f.name !== fileName)\n      });\n    }\n  };\n  const handleExportCase = () => {\n    if (!currentCase) return;\n    const dataStr = JSON.stringify(currentCase, null, 2);\n    const blob = new Blob([dataStr], {\n      type: \"application/json\"\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `lexmedical_${currentCase.name.replace(/\\s+/g, '_')}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n  const handleImportClick = () => {\n    var _fileInputRef$current;\n    (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n  };\n  const handleImportFile = e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = event => {\n      try {\n        var _event$target;\n        const json = JSON.parse((_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.result);\n        if (json.id && json.liability && json.damages) {\n          hydratingRef.current = true;\n          setCurrentCase(json);\n          alert('התיק נטען בהצלחה! השינויים יישמרו אוטומטית.');\n          setActiveStep(0);\n        } else {\n          alert('קובץ לא תקין.');\n        }\n      } catch (err) {\n        alert('שגיאה בטעינת הקובץ');\n      }\n    };\n    reader.readAsText(file);\n    if (fileInputRef.current) fileInputRef.current.value = '';\n  };\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(LoginScreen, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 12\n    }, this);\n  }\n  if (showAdminDashboard) {\n    return /*#__PURE__*/_jsxDEV(AdminDashboard, {\n      currentUserName: user.username,\n      onEditCase: handleAdminEditCase,\n      onLogout: handleLogout\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 7\n    }, this);\n  }\n  if (isLoadingCases || !currentCase) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen flex items-center justify-center bg-slate-100 text-slate-600\",\n      children: loadError || 'טוען תיקים מהשרת...'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen flex flex-col md:flex-row bg-slate-100 text-slate-900 font-sans print:bg-white\",\n    dir: \"rtl\",\n    children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"w-full md:w-64 bg-slate-900 text-slate-300 flex flex-col shrink-0 no-print\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6 border-b border-slate-800\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-bold text-white serif tracking-wide\",\n          children: \"LexMedical\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2 mt-2 text-xs text-slate-400\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-2 h-2 rounded-full bg-green-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 14\n          }, this), \"\\u05DE\\u05D7\\u05D5\\u05D1\\u05E8: \", user.username]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6 flex-1 overflow-y-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveStep(0),\n            className: `w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 0 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(Home, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 351,\n                columnNumber: 57\n              }, this), \" \\u05DC\\u05D5\\u05D7 \\u05D1\\u05E7\\u05E8\\u05D4\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 16\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs font-bold text-slate-500 uppercase tracking-wider mt-6 mb-2 flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(FolderOpen, {\n              className: \"w-3 h-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 16\n            }, this), \" \\u05EA\\u05D4\\u05DC\\u05D9\\u05DA \\u05E2\\u05D1\\u05D5\\u05D3\\u05D4\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveStep(1),\n            className: `w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 1 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(Shield, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 357,\n                columnNumber: 57\n              }, this), \" \\u05E0\\u05D9\\u05EA\\u05D5\\u05D7 \\u05D7\\u05D1\\u05D5\\u05EA\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 16\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveStep(2),\n            className: `w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 2 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(Activity, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 57\n              }, this), \" \\u05E0\\u05D6\\u05E7 \\u05D5\\u05EA\\u05D7\\u05E9\\u05D9\\u05D1\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 16\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveStep(3),\n            className: `w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 3 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(BookOpen, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 363,\n                columnNumber: 57\n              }, this), \" \\u05E0\\u05D9\\u05DE\\u05D5\\u05E7\\u05D9\\u05DD\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 16\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveStep(4),\n            className: `w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 4 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(FileText, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 57\n              }, this), \" \\u05D3\\u05D5\\u05D7 \\u05DE\\u05E1\\u05DB\\u05DD\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 16\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 14\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-8 pt-6 border-t border-slate-800 space-y-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2\",\n            children: \"\\u05E0\\u05D9\\u05D4\\u05D5\\u05DC \\u05E0\\u05EA\\u05D5\\u05E0\\u05D9\\u05DD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleCreateNewCase(user.username),\n            className: \"w-full flex items-center gap-3 p-2 text-sm hover:bg-slate-800 rounded text-slate-400 hover:text-white\",\n            children: [/*#__PURE__*/_jsxDEV(Upload, {\n              className: \"w-4 h-4 rotate-180\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 15\n            }, this), \" \\u05EA\\u05D9\\u05E7 \\u05D7\\u05D3\\u05E9\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleExportCase,\n            className: \"w-full flex items-center gap-3 p-2 text-sm hover:bg-slate-800 rounded text-slate-400 hover:text-white\",\n            children: [/*#__PURE__*/_jsxDEV(Download, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 16\n            }, this), \" \\u05E9\\u05DE\\u05D5\\u05E8 \\u05EA\\u05D9\\u05E7 \\u05DC\\u05E7\\u05D5\\u05D1\\u05E5\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 378,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleImportClick,\n            className: \"w-full flex items-center gap-3 p-2 text-sm hover:bg-slate-800 rounded text-slate-400 hover:text-white\",\n            children: [/*#__PURE__*/_jsxDEV(Upload, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 382,\n              columnNumber: 16\n            }, this), \" \\u05D8\\u05E2\\u05DF \\u05EA\\u05D9\\u05E7 \\u05DE\\u05E7\\u05D5\\u05D1\\u05E5\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            ref: fileInputRef,\n            onChange: handleImportFile,\n            className: \"hidden\",\n            accept: \".json\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 13\n          }, this), loadError && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-red-400\",\n            children: loadError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 27\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6 border-t border-slate-800 space-y-3\",\n        children: [isAdmin && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowAdminDashboard(true),\n          className: \"w-full flex items-center gap-2 text-sm text-slate-400 hover:text-white transition\",\n          children: [/*#__PURE__*/_jsxDEV(LayoutDashboard, {\n            className: \"w-4 h-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 15\n          }, this), \" \\u05D7\\u05D6\\u05E8\\u05D4 \\u05DC\\u05D3\\u05E9\\u05D1\\u05D5\\u05E8\\u05D3\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"w-full flex items-center gap-2 text-sm text-red-400 hover:text-red-300 transition\",\n          children: [/*#__PURE__*/_jsxDEV(LogOut, {\n            className: \"w-4 h-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 13\n          }, this), \" \\u05D4\\u05EA\\u05E0\\u05EA\\u05E7\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"flex-1 flex flex-col h-screen overflow-hidden print:h-auto print:overflow-visible\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"h-16 bg-white border-b border-slate-200 flex items-center justify-between px-8 shrink-0 no-print\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2 text-sm text-slate-500\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-semibold text-slate-800\",\n            children: \"\\u05E9\\u05DD \\u05D4\\u05EA\\u05D9\\u05E7:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"border-b border-transparent hover:border-slate-300 focus:border-blue-500 focus:outline-none px-1 transition w-64\",\n            value: currentCase.name,\n            onChange: e => setCurrentCase({\n              ...currentCase,\n              name: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 14\n          }, this), currentCase.attorney !== user.username && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"bg-yellow-100 text-yellow-800 text-xs px-2 py-0.5 rounded-full\",\n            children: [\"\\u05E6\\u05E4\\u05D9\\u05D9\\u05D4 \\u05D1\\u05EA\\u05D9\\u05E7 \\u05E9\\u05DC \", currentCase.attorney]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 16\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-slate-500 min-w-[80px] text-right\",\n            children: [saveStatus === 'saving' && 'שומר...', saveStatus === 'saved' && 'נשמר', saveStatus === 'error' && 'שמירה נכשלה']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveStep(prev => Math.max(0, prev - 1)),\n            disabled: activeStep === 0,\n            className: \"text-sm text-slate-500 hover:text-slate-800 disabled:opacity-30\",\n            children: \"\\u05D7\\u05D6\\u05D5\\u05E8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 416,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveStep(prev => Math.min(4, prev + 1)),\n            disabled: activeStep === 4,\n            className: \"bg-slate-900 text-white px-4 py-2 rounded text-sm font-medium hover:bg-slate-800 flex items-center gap-2 disabled:opacity-50\",\n            children: [activeStep === 0 ? 'התחל עבודה' : 'לשלב הבא', \" \", /*#__PURE__*/_jsxDEV(ChevronLeft, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 63\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 14\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-y-auto p-8 print:p-0 print:overflow-visible\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"max-w-5xl mx-auto print:max-w-none pb-20\",\n          children: [activeStep === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"animate-fadeIn\",\n            children: /*#__PURE__*/_jsxDEV(CaseDashboard, {\n              caseData: currentCase,\n              navigateToStep: setActiveStep\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 66\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 34\n          }, this), activeStep === 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"animate-fadeIn space-y-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-white p-6 rounded-lg shadow-sm border border-slate-200\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between items-center mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-bold text-slate-700\",\n                  children: \"\\u05E8\\u05E7\\u05E2 \\u05E2\\u05D5\\u05D1\\u05D3\\u05EA\\u05D9 / \\u05E1\\u05D9\\u05DB\\u05D5\\u05DD \\u05EA\\u05D9\\u05E7\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 430,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"relative\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"file\",\n                    id: \"summary-upload\",\n                    className: \"hidden\",\n                    accept: \".pdf,.doc,.docx,.txt\",\n                    onChange: handleSummaryFileUpload\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 432,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"summary-upload\",\n                    className: \"cursor-pointer flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 bg-blue-50 px-2 py-1 rounded border border-blue-100 transition\",\n                    children: [/*#__PURE__*/_jsxDEV(UploadCloud, {\n                      className: \"w-3 h-3\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 433,\n                      columnNumber: 211\n                    }, this), \" \\u05E6\\u05E8\\u05E3 \\u05E7\\u05D5\\u05D1\\u05E5\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 433,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 431,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 429,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                className: \"w-full p-4 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none transition h-32\",\n                placeholder: \"\\u05D4\\u05D6\\u05DF \\u05DB\\u05D0\\u05DF \\u05D0\\u05EA \\u05D4\\u05E2\\u05D5\\u05D1\\u05D3\\u05D5\\u05EA \\u05D4\\u05DE\\u05E2\\u05D5\\u05D1\\u05D3\\u05D5\\u05EA...\",\n                value: currentCase.summary,\n                onChange: e => setCurrentCase({\n                  ...currentCase,\n                  summary: e.target.value\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 19\n              }, this), currentCase.summaryFiles && currentCase.summaryFiles.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-3 flex flex-wrap gap-2\",\n                children: currentCase.summaryFiles.map((file, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center gap-2 bg-slate-100 text-slate-700 text-xs px-3 py-1 rounded-full border border-slate-200\",\n                  children: [/*#__PURE__*/_jsxDEV(FileText, {\n                    className: \"w-3 h-3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 441,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"truncate max-w-[150px]\",\n                    children: file.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 441,\n                    columnNumber: 59\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => removeSummaryFile(file.name),\n                    className: \"text-slate-400 hover:text-red-500 ml-1\",\n                    children: \"\\xD7\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 442,\n                    columnNumber: 27\n                  }, this)]\n                }, idx, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 440,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 438,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 428,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(LiabilityStep, {\n              caseData: currentCase,\n              updateCaseData: setCurrentCase\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 448,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 15\n          }, this), activeStep === 2 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"animate-fadeIn\",\n            children: /*#__PURE__*/_jsxDEV(DamagesStep, {\n              caseData: currentCase,\n              updateCaseData: setCurrentCase\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 66\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 34\n          }, this), activeStep === 3 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"animate-fadeIn\",\n            children: /*#__PURE__*/_jsxDEV(ReasoningStep, {\n              caseData: currentCase\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 452,\n              columnNumber: 66\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 34\n          }, this), activeStep === 4 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"animate-fadeIn\",\n            children: /*#__PURE__*/_jsxDEV(ReportStep, {\n              caseData: currentCase\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 453,\n              columnNumber: 66\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 338,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"BFg4LvaiBZ6ca6r3iDJoS6i87LQ=\", false, function () {\n  return [useAuth];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useAuth","createCase","apiCreateCase","listCases","apiListCases","updateCase","apiUpdateCase","LoginScreen","AdminDashboard","LiabilityStep","DamagesStep","ReasoningStep","ReportStep","CaseDashboard","FolderOpen","ChevronLeft","Shield","Activity","UploadCloud","FileText","LogOut","LayoutDashboard","BookOpen","Download","Upload","Home","jsxDEV","_jsxDEV","createEmptyCase","attorney","id","Date","now","toString","name","toLocaleDateString","lastUpdated","toISOString","summary","summaryFiles","liability","issues","medicalRecordQuality","doctrines","precedents","expertsPlaintiff","expertsDefense","expertCourtOpinions","expertCourtStance","aggravatingFactors","mitigatingFactors","probability","probabilityRange","uncertainty","strengthsPlaintiff","weaknessesPlaintiff","strengthsDefense","weaknessesDefense","damages","dateOfBirth","gender","dateOfEvent","setFullYear","getFullYear","split","dateOfCalc","dateOfRetirement","ageAtInjury","currentAge","lifeExpectancy","wagePreInjury","wagePostInjury","permanentDisabilityMedical","permanentDisabilityFunctional","daysOfHospitalization","interestRate","heads","isActive","parameters","calculatedAmount","notes","App","_s","user","logout","activeStep","setActiveStep","showAdminDashboard","setShowAdminDashboard","setCaseList","currentCaseId","setCurrentCaseId","currentCase","setCurrentCase","saveStatus","setSaveStatus","isLoadingCases","setIsLoadingCases","loadError","setLoadError","fileInputRef","saveTimeoutRef","resetStatusTimeoutRef","hydratingRef","isAdmin","role","cleanupClientState","current","clearTimeout","normalizeCaseData","record","attorneyFallback","safeData","data","title","handleCreateNewCase","attorneyName","template","created","prev","normalized","error","console","cancelled","bootstrap","cases","length","username","sorted","sort","a","b","updatedAt","getTime","primary","handleLogout","handleAdminEditCase","caseData","setTimeout","updated","filtered","filter","c","handleSummaryFileUpload","e","target","files","file","newFile","size","type","lastModified","removeSummaryFile","fileName","f","handleExportCase","dataStr","JSON","stringify","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","replace","body","appendChild","click","removeChild","handleImportClick","_fileInputRef$current","handleImportFile","_e$target$files","reader","FileReader","onload","event","_event$target","json","parse","result","alert","err","readAsText","value","_jsxFileName","lineNumber","columnNumber","currentUserName","onEditCase","onLogout","className","children","dir","onClick","ref","onChange","accept","Math","max","disabled","min","navigateToStep","htmlFor","placeholder","map","idx","updateCaseData","_c","$RefreshReg$"],"sources":["C:/Office-Apps/LexMedical-App/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { CaseData, AttachedFile } from './types';\nimport { useAuth } from './context/AuthContext';\nimport {\n  CaseRecord,\n  createCase as apiCreateCase,\n  listCases as apiListCases,\n  updateCase as apiUpdateCase,\n} from './services/api';\nimport LoginScreen from './components/LoginScreen';\nimport AdminDashboard from './components/AdminDashboard';\nimport LiabilityStep from './components/LiabilityStep';\nimport DamagesStep from './components/DamagesStep';\nimport ReasoningStep from './components/ReasoningStep';\nimport ReportStep from './components/ReportStep';\nimport CaseDashboard from './components/CaseDashboard';\nimport {\n  FolderOpen,\n  ChevronLeft,\n  Shield,\n  Activity,\n  UploadCloud,\n  FileText,\n  LogOut,\n  LayoutDashboard,\n  BookOpen,\n  Download,\n  Upload,\n  Home,\n} from 'lucide-react';\n\nconst createEmptyCase = (attorney: string): CaseData => ({\n  id: Date.now().toString(),\n  name: 'תיק חדש ' + new Date().toLocaleDateString('he-IL'),\n  attorney,\n  lastUpdated: new Date().toISOString(),\n  summary: '',\n  summaryFiles: [],\n  liability: {\n    issues: [],\n    medicalRecordQuality: 'Complete',\n    doctrines: [],\n    precedents: [],\n    expertsPlaintiff: [],\n    expertsDefense: [],\n    expertCourtOpinions: [], \n    expertCourtStance: 'None', \n    aggravatingFactors: 2,\n    mitigatingFactors: 2,\n    probability: 50,\n    probabilityRange: [40, 60],\n    uncertainty: 'Medium',\n    strengthsPlaintiff: [''],\n    weaknessesPlaintiff: [''],\n    strengthsDefense: [''],\n    weaknessesDefense: ['']\n  },\n  damages: {\n    dateOfBirth: '1990-01-01', \n    gender: 'Male',\n    dateOfEvent: new Date(new Date().setFullYear(new Date().getFullYear() - 2)).toISOString().split('T')[0], \n    dateOfCalc: new Date().toISOString().split('T')[0],\n    dateOfRetirement: '',\n    ageAtInjury: 0, \n    currentAge: 0, \n    lifeExpectancy: 82, \n    wagePreInjury: 10000,\n    wagePostInjury: 0,\n    permanentDisabilityMedical: 10,\n    permanentDisabilityFunctional: 10,\n    daysOfHospitalization: 0,\n    interestRate: 3,\n    heads: [\n      { id: '1', name: 'הפסד שכר לעבר', isActive: true, parameters: {}, calculatedAmount: 0, notes: '' },\n      { id: '2', name: 'הפסד שכר לעתיד', isActive: true, parameters: {}, calculatedAmount: 0, notes: '' },\n      { id: '3', name: 'הפסד פנסיה ותנאים סוציאליים', isActive: true, parameters: {}, calculatedAmount: 0, notes: '' },\n      { id: '4', name: 'כאב וסבל', isActive: true, parameters: {}, calculatedAmount: 0, notes: '' },\n      { id: '5', name: 'עזרת צד ג׳ לעבר', isActive: false, parameters: {}, calculatedAmount: 0, notes: '' },\n      { id: '6', name: 'עזרת צד ג׳ לעתיד', isActive: false, parameters: {}, calculatedAmount: 0, notes: '' },\n      { id: '7', name: 'הוצאות רפואיות', isActive: false, parameters: {}, calculatedAmount: 0, notes: '' },\n      { id: '8', name: 'ניידות ונסיעות', isActive: false, parameters: {}, calculatedAmount: 0, notes: '' },\n    ],\n    precedents: []\n  }\n});\n\nconst App: React.FC = () => {\n  const { user, logout } = useAuth();\n  const [activeStep, setActiveStep] = useState<number>(0);\n  const [showAdminDashboard, setShowAdminDashboard] = useState(false);\n  const [, setCaseList] = useState<CaseRecord[]>([]);\n  const [currentCaseId, setCurrentCaseId] = useState<string | null>(null);\n  const [currentCase, setCurrentCase] = useState<CaseData | null>(null);\n  const [saveStatus, setSaveStatus] = useState<'idle' | 'saving' | 'saved' | 'error'>('idle');\n  const [isLoadingCases, setIsLoadingCases] = useState(false);\n  const [loadError, setLoadError] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const saveTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const resetStatusTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const hydratingRef = useRef(false);\n\n  const isAdmin = user?.role === 'admin';\n\n  const cleanupClientState = () => {\n    setCaseList([]);\n    setCurrentCaseId(null);\n    setCurrentCase(null);\n    setShowAdminDashboard(false);\n    setActiveStep(0);\n    setSaveStatus('idle');\n    if (saveTimeoutRef.current) {\n      clearTimeout(saveTimeoutRef.current);\n      saveTimeoutRef.current = null;\n    }\n    if (resetStatusTimeoutRef.current) {\n      clearTimeout(resetStatusTimeoutRef.current);\n      resetStatusTimeoutRef.current = null;\n    }\n  };\n\n  const normalizeCaseData = (record: CaseRecord, attorneyFallback: string): CaseData => {\n    const safeData = (record.data as CaseData) || createEmptyCase(attorneyFallback);\n    return {\n      ...createEmptyCase(attorneyFallback),\n      ...safeData,\n      id: record.id,\n      name: safeData.name || record.title || `תיק ${new Date().toLocaleDateString('he-IL')}`,\n      attorney: safeData.attorney || attorneyFallback,\n    };\n  };\n\n  const handleCreateNewCase = useCallback(async (attorneyName: string) => {\n    if (!user) return;\n    setIsLoadingCases(true);\n    setLoadError(null);\n    try {\n      const template = createEmptyCase(attorneyName);\n      const created = await apiCreateCase({ title: template.name, data: template });\n      setCaseList((prev) => [created, ...prev]);\n      const normalized = { ...template, id: created.id };\n      setCurrentCaseId(created.id);\n      hydratingRef.current = true;\n      setCurrentCase(normalized);\n      setActiveStep(0);\n    } catch (error) {\n      console.error(error);\n      setLoadError('יצירת תיק חדש נכשלה.');\n    } finally {\n      setIsLoadingCases(false);\n    }\n  }, [user]);\n\n  useEffect(() => {\n    let cancelled = false;\n    const bootstrap = async () => {\n      if (!user) {\n        cleanupClientState();\n        return;\n      }\n      setIsLoadingCases(true);\n      setLoadError(null);\n      try {\n        const cases = await apiListCases();\n        if (cancelled) return;\n        setCaseList(cases);\n        setShowAdminDashboard(isAdmin);\n        if (!cases.length) {\n          await handleCreateNewCase(user.username);\n          return;\n        }\n        const sorted = [...cases].sort(\n          (a, b) => new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime(),\n        );\n        const primary = sorted[0];\n        setCurrentCaseId(primary.id);\n        hydratingRef.current = true;\n        setCurrentCase(normalizeCaseData(primary, user.username));\n        setActiveStep(0);\n      } catch (error) {\n        console.error(error);\n        if (!cancelled) {\n          setLoadError('טעינת התיקים נכשלה. נסה שוב בעוד רגע.');\n        }\n      } finally {\n        if (!cancelled) {\n          setIsLoadingCases(false);\n        }\n      }\n    };\n\n    bootstrap();\n\n    return () => {\n      cancelled = true;\n    };\n  }, [user, isAdmin, handleCreateNewCase]);\n\n  const handleLogout = () => {\n    logout();\n    cleanupClientState();\n  };\n\n  const handleAdminEditCase = (caseData: CaseData) => {\n    setCurrentCaseId(caseData.id);\n    hydratingRef.current = true;\n    setCurrentCase(caseData);\n    setShowAdminDashboard(false);\n    setActiveStep(0);\n  };\n\n  useEffect(() => {\n    if (!user || !currentCaseId || !currentCase || showAdminDashboard) return;\n    if (hydratingRef.current) {\n      hydratingRef.current = false;\n      return;\n    }\n    if (saveTimeoutRef.current) {\n      clearTimeout(saveTimeoutRef.current);\n    }\n    setSaveStatus('saving');\n    saveTimeoutRef.current = setTimeout(async () => {\n      try {\n        const updated = await apiUpdateCase(currentCaseId, {\n          title: currentCase.name,\n          data: currentCase,\n        });\n        setCaseList((prev) => {\n          const filtered = prev.filter((c) => c.id !== updated.id);\n          return [updated, ...filtered];\n        });\n        setSaveStatus('saved');\n        if (resetStatusTimeoutRef.current) {\n          clearTimeout(resetStatusTimeoutRef.current);\n        }\n        resetStatusTimeoutRef.current = setTimeout(() => setSaveStatus('idle'), 1500);\n      } catch (error) {\n        console.error(error);\n        setSaveStatus('error');\n      }\n    }, 1200);\n\n    return () => {\n      if (saveTimeoutRef.current) {\n        clearTimeout(saveTimeoutRef.current);\n        saveTimeoutRef.current = null;\n      }\n    };\n  }, [currentCase, currentCaseId, user, showAdminDashboard]);\n\n  const handleSummaryFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0] && currentCase) {\n      const file = e.target.files[0];\n      const newFile: AttachedFile = {\n        name: file.name,\n        size: file.size,\n        type: file.type,\n        lastModified: file.lastModified\n      };\n      setCurrentCase({\n        ...currentCase,\n        summaryFiles: [...(currentCase.summaryFiles || []), newFile]\n      });\n    }\n  };\n\n  const removeSummaryFile = (fileName: string) => {\n    if (currentCase) {\n      setCurrentCase({\n        ...currentCase,\n        summaryFiles: currentCase.summaryFiles.filter((f: AttachedFile) => f.name !== fileName)\n      });\n    }\n  };\n\n  const handleExportCase = () => {\n    if (!currentCase) return;\n    const dataStr = JSON.stringify(currentCase, null, 2);\n    const blob = new Blob([dataStr], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `lexmedical_${currentCase.name.replace(/\\s+/g, '_')}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const handleImportClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleImportFile = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      try {\n        const json = JSON.parse(event.target?.result as string);\n        if (json.id && json.liability && json.damages) {\n          hydratingRef.current = true;\n          setCurrentCase(json);\n          alert('התיק נטען בהצלחה! השינויים יישמרו אוטומטית.');\n          setActiveStep(0);\n        } else {\n          alert('קובץ לא תקין.');\n        }\n      } catch (err) {\n        alert('שגיאה בטעינת הקובץ');\n      }\n    };\n    reader.readAsText(file);\n    if (fileInputRef.current) fileInputRef.current.value = '';\n  };\n\n  if (!user) {\n    return <LoginScreen />;\n  }\n\n  if (showAdminDashboard) {\n    return (\n      <AdminDashboard\n        currentUserName={user.username}\n        onEditCase={handleAdminEditCase}\n        onLogout={handleLogout}\n      />\n    );\n  }\n\n  if (isLoadingCases || !currentCase) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-slate-100 text-slate-600\">\n        {loadError || 'טוען תיקים מהשרת...'}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex flex-col md:flex-row bg-slate-100 text-slate-900 font-sans print:bg-white\" dir=\"rtl\">\n      <aside className=\"w-full md:w-64 bg-slate-900 text-slate-300 flex flex-col shrink-0 no-print\">\n        <div className=\"p-6 border-b border-slate-800\">\n          <h1 className=\"text-xl font-bold text-white serif tracking-wide\">LexMedical</h1>\n          <div className=\"flex items-center gap-2 mt-2 text-xs text-slate-400\">\n             <div className=\"w-2 h-2 rounded-full bg-green-500\"></div>\n             מחובר: {user.username}\n          </div>\n        </div>\n\n        <div className=\"p-6 flex-1 overflow-y-auto\">\n          <nav className=\"space-y-2\">\n             <button onClick={() => setActiveStep(0)} className={`w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 0 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`}>\n               <div className=\"flex items-center gap-3\"><Home className=\"w-4 h-4\" /> לוח בקרה</div>\n             </button>\n             <div className=\"text-xs font-bold text-slate-500 uppercase tracking-wider mt-6 mb-2 flex items-center gap-2\">\n               <FolderOpen className=\"w-3 h-3\" /> תהליך עבודה\n             </div>\n             <button onClick={() => setActiveStep(1)} className={`w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 1 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`}>\n               <div className=\"flex items-center gap-3\"><Shield className=\"w-4 h-4\" /> ניתוח חבות</div>\n             </button>\n             <button onClick={() => setActiveStep(2)} className={`w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 2 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`}>\n               <div className=\"flex items-center gap-3\"><Activity className=\"w-4 h-4\" /> נזק ותחשיב</div>\n             </button>\n             <button onClick={() => setActiveStep(3)} className={`w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 3 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`}>\n               <div className=\"flex items-center gap-3\"><BookOpen className=\"w-4 h-4\" /> נימוקים</div>\n             </button>\n             <button onClick={() => setActiveStep(4)} className={`w-full flex items-center justify-between p-3 rounded text-sm transition ${activeStep === 4 ? 'bg-blue-900/50 text-white border-r-2 border-blue-500' : 'hover:bg-slate-800'}`}>\n               <div className=\"flex items-center gap-3\"><FileText className=\"w-4 h-4\" /> דוח מסכם</div>\n             </button>\n          </nav>\n\n          <div className=\"mt-8 pt-6 border-t border-slate-800 space-y-3\">\n            <div className=\"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2\">ניהול נתונים</div>\n            <button\n              onClick={() => handleCreateNewCase(user.username)}\n              className=\"w-full flex items-center gap-3 p-2 text-sm hover:bg-slate-800 rounded text-slate-400 hover:text-white\"\n            >\n              <Upload className=\"w-4 h-4 rotate-180\" /> תיק חדש\n            </button>\n            <button onClick={handleExportCase} className=\"w-full flex items-center gap-3 p-2 text-sm hover:bg-slate-800 rounded text-slate-400 hover:text-white\">\n               <Download className=\"w-4 h-4\" /> שמור תיק לקובץ\n            </button>\n            <button onClick={handleImportClick} className=\"w-full flex items-center gap-3 p-2 text-sm hover:bg-slate-800 rounded text-slate-400 hover:text-white\">\n               <Upload className=\"w-4 h-4\" /> טען תיק מקובץ\n            </button>\n            <input type=\"file\" ref={fileInputRef} onChange={handleImportFile} className=\"hidden\" accept=\".json\" />\n            {loadError && <p className=\"text-xs text-red-400\">{loadError}</p>}\n          </div>\n        </div>\n\n        <div className=\"p-6 border-t border-slate-800 space-y-3\">\n          {isAdmin && (\n            <button onClick={() => setShowAdminDashboard(true)} className=\"w-full flex items-center gap-2 text-sm text-slate-400 hover:text-white transition\">\n              <LayoutDashboard className=\"w-4 h-4\" /> חזרה לדשבורד\n            </button>\n          )}\n          <button onClick={handleLogout} className=\"w-full flex items-center gap-2 text-sm text-red-400 hover:text-red-300 transition\">\n            <LogOut className=\"w-4 h-4\" /> התנתק\n          </button>\n        </div>\n      </aside>\n\n      <main className=\"flex-1 flex flex-col h-screen overflow-hidden print:h-auto print:overflow-visible\">\n        <header className=\"h-16 bg-white border-b border-slate-200 flex items-center justify-between px-8 shrink-0 no-print\">\n           <div className=\"flex items-center gap-2 text-sm text-slate-500\">\n             <span className=\"font-semibold text-slate-800\">שם התיק:</span>\n             <input className=\"border-b border-transparent hover:border-slate-300 focus:border-blue-500 focus:outline-none px-1 transition w-64\" value={currentCase.name} onChange={(e) => setCurrentCase({...currentCase, name: e.target.value})} />\n             {currentCase.attorney !== user.username && (\n               <span className=\"bg-yellow-100 text-yellow-800 text-xs px-2 py-0.5 rounded-full\">צפייה בתיק של {currentCase.attorney}</span>\n             )}\n           </div>\n           <div className=\"flex items-center gap-4\">\n             <span className=\"text-xs text-slate-500 min-w-[80px] text-right\">\n               {saveStatus === 'saving' && 'שומר...'}\n               {saveStatus === 'saved' && 'נשמר'}\n               {saveStatus === 'error' && 'שמירה נכשלה'}\n             </span>\n             <button onClick={() => setActiveStep(prev => Math.max(0, prev - 1))} disabled={activeStep === 0} className=\"text-sm text-slate-500 hover:text-slate-800 disabled:opacity-30\">חזור</button>\n             <button onClick={() => setActiveStep(prev => Math.min(4, prev + 1))} disabled={activeStep === 4} className=\"bg-slate-900 text-white px-4 py-2 rounded text-sm font-medium hover:bg-slate-800 flex items-center gap-2 disabled:opacity-50\">\n               {activeStep === 0 ? 'התחל עבודה' : 'לשלב הבא'} <ChevronLeft className=\"w-4 h-4\" />\n             </button>\n           </div>\n        </header>\n\n        <div className=\"flex-1 overflow-y-auto p-8 print:p-0 print:overflow-visible\">\n          <div className=\"max-w-5xl mx-auto print:max-w-none pb-20\">\n            {activeStep === 0 && <div className=\"animate-fadeIn\"><CaseDashboard caseData={currentCase} navigateToStep={setActiveStep} /></div>}\n            {activeStep === 1 && (\n              <div className=\"animate-fadeIn space-y-8\">\n                <div className=\"bg-white p-6 rounded-lg shadow-sm border border-slate-200\">\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <label className=\"block text-sm font-bold text-slate-700\">רקע עובדתי / סיכום תיק</label>\n                    <div className=\"relative\">\n                      <input type=\"file\" id=\"summary-upload\" className=\"hidden\" accept=\".pdf,.doc,.docx,.txt\" onChange={handleSummaryFileUpload} />\n                      <label htmlFor=\"summary-upload\" className=\"cursor-pointer flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 bg-blue-50 px-2 py-1 rounded border border-blue-100 transition\"><UploadCloud className=\"w-3 h-3\" /> צרף קובץ</label>\n                    </div>\n                  </div>\n                  <textarea className=\"w-full p-4 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none transition h-32\" placeholder=\"הזן כאן את העובדות המעובדות...\" value={currentCase.summary} onChange={(e) => setCurrentCase({...currentCase, summary: e.target.value})} />\n                  {currentCase.summaryFiles && currentCase.summaryFiles.length > 0 && (\n                    <div className=\"mt-3 flex flex-wrap gap-2\">\n                      {currentCase.summaryFiles.map((file: AttachedFile, idx: number) => (\n                        <div key={idx} className=\"flex items-center gap-2 bg-slate-100 text-slate-700 text-xs px-3 py-1 rounded-full border border-slate-200\">\n                          <FileText className=\"w-3 h-3\" /><span className=\"truncate max-w-[150px]\">{file.name}</span>\n                          <button onClick={() => removeSummaryFile(file.name)} className=\"text-slate-400 hover:text-red-500 ml-1\">×</button>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n                <LiabilityStep caseData={currentCase} updateCaseData={setCurrentCase} />\n              </div>\n            )}\n            {activeStep === 2 && <div className=\"animate-fadeIn\"><DamagesStep caseData={currentCase} updateCaseData={setCurrentCase} /></div>}\n            {activeStep === 3 && <div className=\"animate-fadeIn\"><ReasoningStep caseData={currentCase} /></div>}\n            {activeStep === 4 && <div className=\"animate-fadeIn\"><ReportStep caseData={currentCase} /></div>}\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}