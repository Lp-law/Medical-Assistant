{"ast":null,"code":"const shouldBlockKey=(storageName,action,key)=>{if(!key.startsWith('lexmedical_')){return false;}const message=\"[storage-guard] \".concat(storageName,\".\").concat(action,\" blocked for PHI key \\\"\").concat(key,\"\\\". Data stays server-side only.\");if(process.env.NODE_ENV!=='production'){throw new Error(message);}// eslint-disable-next-line no-console\nconsole.warn(message);return true;};const warnClear=storageName=>{const message=\"[storage-guard] \".concat(storageName,\".clear() called. PHI is never stored locally.\");// eslint-disable-next-line no-console\nconsole.warn(message);};const patchStorage=(storageName,storage)=>{if(!storage)return;const originalSet=storage.setItem.bind(storage);storage.setItem=(key,value)=>{if(shouldBlockKey(storageName,'setItem',key)){return;}originalSet(key,value);};const originalGet=storage.getItem.bind(storage);storage.getItem=key=>{if(shouldBlockKey(storageName,'getItem',key)){return null;}return originalGet(key);};const originalRemove=storage.removeItem.bind(storage);storage.removeItem=key=>{if(shouldBlockKey(storageName,'removeItem',key)){return;}originalRemove(key);};const originalClear=storage.clear.bind(storage);storage.clear=()=>{warnClear(storageName);originalClear();};};export const applyStorageGuard=()=>{if(typeof window==='undefined'){return;}patchStorage('localStorage',window.localStorage);patchStorage('sessionStorage',window.sessionStorage);};","map":{"version":3,"names":["shouldBlockKey","storageName","action","key","startsWith","message","concat","process","env","NODE_ENV","Error","console","warn","warnClear","patchStorage","storage","originalSet","setItem","bind","value","originalGet","getItem","originalRemove","removeItem","originalClear","clear","applyStorageGuard","window","localStorage","sessionStorage"],"sources":["C:/Office-Apps/LexMedical-App/src/utils/storageGuard.ts"],"sourcesContent":["const shouldBlockKey = (storageName: string, action: string, key: string): boolean => {\r\n  if (!key.startsWith('lexmedical_')) {\r\n    return false;\r\n  }\r\n  const message = `[storage-guard] ${storageName}.${action} blocked for PHI key \"${key}\". Data stays server-side only.`;\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    throw new Error(message);\r\n  }\r\n  // eslint-disable-next-line no-console\r\n  console.warn(message);\r\n  return true;\r\n};\r\n\r\nconst warnClear = (storageName: string): void => {\r\n  const message = `[storage-guard] ${storageName}.clear() called. PHI is never stored locally.`;\r\n  // eslint-disable-next-line no-console\r\n  console.warn(message);\r\n};\r\n\r\nconst patchStorage = (storageName: 'localStorage' | 'sessionStorage', storage: Storage | undefined): void => {\r\n  if (!storage) return;\r\n\r\n  const originalSet = storage.setItem.bind(storage);\r\n  storage.setItem = (key: string, value: string) => {\r\n    if (shouldBlockKey(storageName, 'setItem', key)) {\r\n      return;\r\n    }\r\n    originalSet(key, value);\r\n  };\r\n\r\n  const originalGet = storage.getItem.bind(storage);\r\n  storage.getItem = (key: string) => {\r\n    if (shouldBlockKey(storageName, 'getItem', key)) {\r\n      return null;\r\n    }\r\n    return originalGet(key);\r\n  };\r\n\r\n  const originalRemove = storage.removeItem.bind(storage);\r\n  storage.removeItem = (key: string) => {\r\n    if (shouldBlockKey(storageName, 'removeItem', key)) {\r\n      return;\r\n    }\r\n    originalRemove(key);\r\n  };\r\n\r\n  const originalClear = storage.clear.bind(storage);\r\n  storage.clear = () => {\r\n    warnClear(storageName);\r\n    originalClear();\r\n  };\r\n};\r\n\r\nexport const applyStorageGuard = (): void => {\r\n  if (typeof window === 'undefined') {\r\n    return;\r\n  }\r\n  patchStorage('localStorage', window.localStorage);\r\n  patchStorage('sessionStorage', window.sessionStorage);\r\n};\r\n\r\n"],"mappings":"AAAA,KAAM,CAAAA,cAAc,CAAGA,CAACC,WAAmB,CAAEC,MAAc,CAAEC,GAAW,GAAc,CACpF,GAAI,CAACA,GAAG,CAACC,UAAU,CAAC,aAAa,CAAC,CAAE,CAClC,MAAO,MAAK,CACd,CACA,KAAM,CAAAC,OAAO,oBAAAC,MAAA,CAAsBL,WAAW,MAAAK,MAAA,CAAIJ,MAAM,4BAAAI,MAAA,CAAyBH,GAAG,oCAAiC,CACrH,GAAII,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,YAAY,CAAE,CACzC,KAAM,IAAI,CAAAC,KAAK,CAACL,OAAO,CAAC,CAC1B,CACA;AACAM,OAAO,CAACC,IAAI,CAACP,OAAO,CAAC,CACrB,MAAO,KAAI,CACb,CAAC,CAED,KAAM,CAAAQ,SAAS,CAAIZ,WAAmB,EAAW,CAC/C,KAAM,CAAAI,OAAO,oBAAAC,MAAA,CAAsBL,WAAW,iDAA+C,CAC7F;AACAU,OAAO,CAACC,IAAI,CAACP,OAAO,CAAC,CACvB,CAAC,CAED,KAAM,CAAAS,YAAY,CAAGA,CAACb,WAA8C,CAAEc,OAA4B,GAAW,CAC3G,GAAI,CAACA,OAAO,CAAE,OAEd,KAAM,CAAAC,WAAW,CAAGD,OAAO,CAACE,OAAO,CAACC,IAAI,CAACH,OAAO,CAAC,CACjDA,OAAO,CAACE,OAAO,CAAG,CAACd,GAAW,CAAEgB,KAAa,GAAK,CAChD,GAAInB,cAAc,CAACC,WAAW,CAAE,SAAS,CAAEE,GAAG,CAAC,CAAE,CAC/C,OACF,CACAa,WAAW,CAACb,GAAG,CAAEgB,KAAK,CAAC,CACzB,CAAC,CAED,KAAM,CAAAC,WAAW,CAAGL,OAAO,CAACM,OAAO,CAACH,IAAI,CAACH,OAAO,CAAC,CACjDA,OAAO,CAACM,OAAO,CAAIlB,GAAW,EAAK,CACjC,GAAIH,cAAc,CAACC,WAAW,CAAE,SAAS,CAAEE,GAAG,CAAC,CAAE,CAC/C,MAAO,KAAI,CACb,CACA,MAAO,CAAAiB,WAAW,CAACjB,GAAG,CAAC,CACzB,CAAC,CAED,KAAM,CAAAmB,cAAc,CAAGP,OAAO,CAACQ,UAAU,CAACL,IAAI,CAACH,OAAO,CAAC,CACvDA,OAAO,CAACQ,UAAU,CAAIpB,GAAW,EAAK,CACpC,GAAIH,cAAc,CAACC,WAAW,CAAE,YAAY,CAAEE,GAAG,CAAC,CAAE,CAClD,OACF,CACAmB,cAAc,CAACnB,GAAG,CAAC,CACrB,CAAC,CAED,KAAM,CAAAqB,aAAa,CAAGT,OAAO,CAACU,KAAK,CAACP,IAAI,CAACH,OAAO,CAAC,CACjDA,OAAO,CAACU,KAAK,CAAG,IAAM,CACpBZ,SAAS,CAACZ,WAAW,CAAC,CACtBuB,aAAa,CAAC,CAAC,CACjB,CAAC,CACH,CAAC,CAED,MAAO,MAAM,CAAAE,iBAAiB,CAAGA,CAAA,GAAY,CAC3C,GAAI,MAAO,CAAAC,MAAM,GAAK,WAAW,CAAE,CACjC,OACF,CACAb,YAAY,CAAC,cAAc,CAAEa,MAAM,CAACC,YAAY,CAAC,CACjDd,YAAY,CAAC,gBAAgB,CAAEa,MAAM,CAACE,cAAc,CAAC,CACvD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}