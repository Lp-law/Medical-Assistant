{"ast":null,"code":"export const API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:4000/api';\nlet authToken = null;\nexport const setAuthToken = token => {\n  authToken = token;\n};\nconst withAuth = init => {\n  const headers = new Headers((init === null || init === void 0 ? void 0 : init.headers) || {});\n  if (authToken) {\n    headers.set('Authorization', `Bearer ${authToken}`);\n  }\n  return {\n    ...init,\n    headers\n  };\n};\nconst request = async (path, init) => {\n  const response = await fetch(`${API_BASE_URL}${path}`, withAuth(init));\n  if (!response.ok) {\n    const errorText = await response.text().catch(() => '');\n    throw new Error(errorText || 'request_failed');\n  }\n  if (response.status === 204) {\n    return undefined;\n  }\n  return await response.json();\n};\nexport { request as apiRequest };\nexport const isApiConfigured = () => Boolean(API_BASE_URL);\nexport const uploadChapterPdf = async (file, options = {}) => {\n  var _options$docType, _options$tags;\n  const formData = new FormData();\n  formData.append('file', file);\n  formData.append('docType', (_options$docType = options.docType) !== null && _options$docType !== void 0 ? _options$docType : 'chapter');\n  if ((_options$tags = options.tags) !== null && _options$tags !== void 0 && _options$tags.length) {\n    formData.append('tags', options.tags.join(','));\n  }\n  if (options.metadata) {\n    formData.append('metadata', JSON.stringify(options.metadata));\n  }\n  const response = await fetch(`${API_BASE_URL}/ingest/pdf`, withAuth({\n    method: 'POST',\n    body: formData\n  }));\n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(errorText || 'api-upload-failed');\n  }\n  const data = await response.json();\n  return data;\n};\nexport const listCases = async () => {\n  var _payload$cases;\n  const payload = await request('/cases', {\n    method: 'GET'\n  });\n  return (_payload$cases = payload.cases) !== null && _payload$cases !== void 0 ? _payload$cases : [];\n};\nexport const createCase = async data => {\n  const payload = await request('/cases', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(data)\n  });\n  return payload.case;\n};\nexport const getCase = async id => {\n  const payload = await request(`/cases/${id}`, {\n    method: 'GET'\n  });\n  return payload.case;\n};\nexport const updateCase = async (id, data) => {\n  const payload = await request(`/cases/${id}`, {\n    method: 'PATCH',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(data)\n  });\n  return payload.case;\n};\nexport const deleteCase = async id => {\n  await request(`/cases/${id}`, {\n    method: 'DELETE'\n  });\n};","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_BASE_URL","authToken","setAuthToken","token","withAuth","init","headers","Headers","set","request","path","response","fetch","ok","errorText","text","catch","Error","status","undefined","json","apiRequest","isApiConfigured","Boolean","uploadChapterPdf","file","options","_options$docType","_options$tags","formData","FormData","append","docType","tags","length","join","metadata","JSON","stringify","method","body","data","listCases","_payload$cases","payload","cases","createCase","case","getCase","id","updateCase","deleteCase"],"sources":["C:/Office-Apps/LexMedical-App/src/services/api.ts"],"sourcesContent":["import { CaseData, IngestedDocument } from '../types';\r\n\r\nexport const API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:4000/api';\r\n\r\ninterface UploadChapterOptions {\r\n  docType?: 'chapter' | 'precedent';\r\n  tags?: string[];\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nlet authToken: string | null = null;\r\n\r\nexport const setAuthToken = (token: string | null): void => {\r\n  authToken = token;\r\n};\r\n\r\nconst withAuth = (init?: RequestInit): RequestInit => {\r\n  const headers = new Headers(init?.headers || {});\r\n  if (authToken) {\r\n    headers.set('Authorization', `Bearer ${authToken}`);\r\n  }\r\n  return {\r\n    ...init,\r\n    headers,\r\n  };\r\n};\r\n\r\nconst request = async <T>(path: string, init?: RequestInit): Promise<T> => {\r\n  const response = await fetch(`${API_BASE_URL}${path}`, withAuth(init));\r\n  if (!response.ok) {\r\n    const errorText = await response.text().catch(() => '');\r\n    throw new Error(errorText || 'request_failed');\r\n  }\r\n  if (response.status === 204) {\r\n    return undefined as T;\r\n  }\r\n  return (await response.json()) as T;\r\n};\r\n\r\nexport { request as apiRequest };\r\n\r\nexport const isApiConfigured = (): boolean => Boolean(API_BASE_URL);\r\n\r\nexport const uploadChapterPdf = async (file: File, options: UploadChapterOptions = {}): Promise<IngestedDocument> => {\r\n  const formData = new FormData();\r\n  formData.append('file', file);\r\n  formData.append('docType', options.docType ?? 'chapter');\r\n  if (options.tags?.length) {\r\n    formData.append('tags', options.tags.join(','));\r\n  }\r\n  if (options.metadata) {\r\n    formData.append('metadata', JSON.stringify(options.metadata));\r\n  }\r\n\r\n  const response = await fetch(`${API_BASE_URL}/ingest/pdf`, withAuth({ method: 'POST', body: formData }));\r\n\r\n  if (!response.ok) {\r\n    const errorText = await response.text();\r\n    throw new Error(errorText || 'api-upload-failed');\r\n  }\r\n\r\n  const data = (await response.json()) as IngestedDocument;\r\n  return data;\r\n};\r\n\r\nexport interface CaseRecord {\r\n  id: string;\r\n  title: string;\r\n  data: CaseData;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport const listCases = async (): Promise<CaseRecord[]> => {\r\n  const payload = await request<{ cases: CaseRecord[] }>('/cases', { method: 'GET' });\r\n  return payload.cases ?? [];\r\n};\r\n\r\nexport const createCase = async (data: { title: string; data: CaseData }): Promise<CaseRecord> => {\r\n  const payload = await request<{ case: CaseRecord }>('/cases', {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  return payload.case;\r\n};\r\n\r\nexport const getCase = async (id: string): Promise<CaseRecord> => {\r\n  const payload = await request<{ case: CaseRecord }>(`/cases/${id}`, { method: 'GET' });\r\n  return payload.case;\r\n};\r\n\r\nexport const updateCase = async (\r\n  id: string,\r\n  data: { title?: string; data?: CaseData },\r\n): Promise<CaseRecord> => {\r\n  const payload = await request<{ case: CaseRecord }>(`/cases/${id}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  return payload.case;\r\n};\r\n\r\nexport const deleteCase = async (id: string): Promise<void> => {\r\n  await request<void>(`/cases/${id}`, { method: 'DELETE' });\r\n};\r\n\r\n\r\n"],"mappings":"AAEA,OAAO,MAAMA,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,sBAAsB,IAAI,2BAA2B;AAQ7F,IAAIC,SAAwB,GAAG,IAAI;AAEnC,OAAO,MAAMC,YAAY,GAAIC,KAAoB,IAAW;EAC1DF,SAAS,GAAGE,KAAK;AACnB,CAAC;AAED,MAAMC,QAAQ,GAAIC,IAAkB,IAAkB;EACpD,MAAMC,OAAO,GAAG,IAAIC,OAAO,CAAC,CAAAF,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEC,OAAO,KAAI,CAAC,CAAC,CAAC;EAChD,IAAIL,SAAS,EAAE;IACbK,OAAO,CAACE,GAAG,CAAC,eAAe,EAAE,UAAUP,SAAS,EAAE,CAAC;EACrD;EACA,OAAO;IACL,GAAGI,IAAI;IACPC;EACF,CAAC;AACH,CAAC;AAED,MAAMG,OAAO,GAAG,MAAAA,CAAUC,IAAY,EAAEL,IAAkB,KAAiB;EACzE,MAAMM,QAAQ,GAAG,MAAMC,KAAK,CAAC,GAAGf,YAAY,GAAGa,IAAI,EAAE,EAAEN,QAAQ,CAACC,IAAI,CAAC,CAAC;EACtE,IAAI,CAACM,QAAQ,CAACE,EAAE,EAAE;IAChB,MAAMC,SAAS,GAAG,MAAMH,QAAQ,CAACI,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,EAAE,CAAC;IACvD,MAAM,IAAIC,KAAK,CAACH,SAAS,IAAI,gBAAgB,CAAC;EAChD;EACA,IAAIH,QAAQ,CAACO,MAAM,KAAK,GAAG,EAAE;IAC3B,OAAOC,SAAS;EAClB;EACA,OAAQ,MAAMR,QAAQ,CAACS,IAAI,CAAC,CAAC;AAC/B,CAAC;AAED,SAASX,OAAO,IAAIY,UAAU;AAE9B,OAAO,MAAMC,eAAe,GAAGA,CAAA,KAAeC,OAAO,CAAC1B,YAAY,CAAC;AAEnE,OAAO,MAAM2B,gBAAgB,GAAG,MAAAA,CAAOC,IAAU,EAAEC,OAA6B,GAAG,CAAC,CAAC,KAAgC;EAAA,IAAAC,gBAAA,EAAAC,aAAA;EACnH,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;EAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAEN,IAAI,CAAC;EAC7BI,QAAQ,CAACE,MAAM,CAAC,SAAS,GAAAJ,gBAAA,GAAED,OAAO,CAACM,OAAO,cAAAL,gBAAA,cAAAA,gBAAA,GAAI,SAAS,CAAC;EACxD,KAAAC,aAAA,GAAIF,OAAO,CAACO,IAAI,cAAAL,aAAA,eAAZA,aAAA,CAAcM,MAAM,EAAE;IACxBL,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAEL,OAAO,CAACO,IAAI,CAACE,IAAI,CAAC,GAAG,CAAC,CAAC;EACjD;EACA,IAAIT,OAAO,CAACU,QAAQ,EAAE;IACpBP,QAAQ,CAACE,MAAM,CAAC,UAAU,EAAEM,IAAI,CAACC,SAAS,CAACZ,OAAO,CAACU,QAAQ,CAAC,CAAC;EAC/D;EAEA,MAAMzB,QAAQ,GAAG,MAAMC,KAAK,CAAC,GAAGf,YAAY,aAAa,EAAEO,QAAQ,CAAC;IAAEmC,MAAM,EAAE,MAAM;IAAEC,IAAI,EAAEX;EAAS,CAAC,CAAC,CAAC;EAExG,IAAI,CAAClB,QAAQ,CAACE,EAAE,EAAE;IAChB,MAAMC,SAAS,GAAG,MAAMH,QAAQ,CAACI,IAAI,CAAC,CAAC;IACvC,MAAM,IAAIE,KAAK,CAACH,SAAS,IAAI,mBAAmB,CAAC;EACnD;EAEA,MAAM2B,IAAI,GAAI,MAAM9B,QAAQ,CAACS,IAAI,CAAC,CAAsB;EACxD,OAAOqB,IAAI;AACb,CAAC;AAUD,OAAO,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAmC;EAAA,IAAAC,cAAA;EAC1D,MAAMC,OAAO,GAAG,MAAMnC,OAAO,CAA0B,QAAQ,EAAE;IAAE8B,MAAM,EAAE;EAAM,CAAC,CAAC;EACnF,QAAAI,cAAA,GAAOC,OAAO,CAACC,KAAK,cAAAF,cAAA,cAAAA,cAAA,GAAI,EAAE;AAC5B,CAAC;AAED,OAAO,MAAMG,UAAU,GAAG,MAAOL,IAAuC,IAA0B;EAChG,MAAMG,OAAO,GAAG,MAAMnC,OAAO,CAAuB,QAAQ,EAAE;IAC5D8B,MAAM,EAAE,MAAM;IACdjC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CkC,IAAI,EAAEH,IAAI,CAACC,SAAS,CAACG,IAAI;EAC3B,CAAC,CAAC;EACF,OAAOG,OAAO,CAACG,IAAI;AACrB,CAAC;AAED,OAAO,MAAMC,OAAO,GAAG,MAAOC,EAAU,IAA0B;EAChE,MAAML,OAAO,GAAG,MAAMnC,OAAO,CAAuB,UAAUwC,EAAE,EAAE,EAAE;IAAEV,MAAM,EAAE;EAAM,CAAC,CAAC;EACtF,OAAOK,OAAO,CAACG,IAAI;AACrB,CAAC;AAED,OAAO,MAAMG,UAAU,GAAG,MAAAA,CACxBD,EAAU,EACVR,IAAyC,KACjB;EACxB,MAAMG,OAAO,GAAG,MAAMnC,OAAO,CAAuB,UAAUwC,EAAE,EAAE,EAAE;IAClEV,MAAM,EAAE,OAAO;IACfjC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CkC,IAAI,EAAEH,IAAI,CAACC,SAAS,CAACG,IAAI;EAC3B,CAAC,CAAC;EACF,OAAOG,OAAO,CAACG,IAAI;AACrB,CAAC;AAED,OAAO,MAAMI,UAAU,GAAG,MAAOF,EAAU,IAAoB;EAC7D,MAAMxC,OAAO,CAAO,UAAUwC,EAAE,EAAE,EAAE;IAAEV,MAAM,EAAE;EAAS,CAAC,CAAC;AAC3D,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}