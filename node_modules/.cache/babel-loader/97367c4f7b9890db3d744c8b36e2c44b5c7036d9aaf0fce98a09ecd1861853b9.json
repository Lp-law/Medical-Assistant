{"ast":null,"code":"import _objectSpread from\"C:/Office-Apps/LexMedical-App/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import{calculateLiabilityScore}from'../services/calculations';import{Scale,Loader2,AlertTriangle,Book}from'lucide-react';import LegalDisclaimer from'./LegalDisclaimer';import SmartAssistant from'./SmartAssistant';import{listKnowledgeDocuments,getKnowledgeDocument}from'../services/knowledgeApi';import QualityBadge from'./QualityBadge';import KnowledgeFlags from'./KnowledgeFlags';import KnowledgeClaimsPanel from'./KnowledgeClaimsPanel';import MedicalTimeline from'./MedicalTimeline';import MedicalQualityBox from'./MedicalQualityBox';import LiteraturePanel from'./LiteraturePanel';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const LiabilityStep=_ref=>{var _medicalDetail$flags,_medicalDetail$claims,_medicalDetail$flags2,_medicalDetail$qualit,_medicalDetail$reason,_medicalDetail$litera;let{caseData,updateCaseData}=_ref;const[localAnalysis,setLocalAnalysis]=useState(caseData.liability);const[assistantOpen,setAssistantOpen]=useState(false);const[evidenceOpen,setEvidenceOpen]=useState(false);const[evidenceInitialized,setEvidenceInitialized]=useState(false);const[medicalDocs,setMedicalDocs]=useState([]);const[selectedMedicalId,setSelectedMedicalId]=useState('');const[medicalDetail,setMedicalDetail]=useState(null);const[medicalListLoading,setMedicalListLoading]=useState(false);const[medicalDetailLoading,setMedicalDetailLoading]=useState(false);const[medicalError,setMedicalError]=useState(null);useEffect(()=>{const result=calculateLiabilityScore(50,localAnalysis.aggravatingFactors,localAnalysis.mitigatingFactors,localAnalysis.medicalRecordQuality,localAnalysis.expertCourtStance);setLocalAnalysis(prev=>_objectSpread(_objectSpread({},prev),{},{probability:result.probability,probabilityRange:result.range,uncertainty:result.uncertainty}));},[localAnalysis.aggravatingFactors,localAnalysis.mitigatingFactors,localAnalysis.medicalRecordQuality,localAnalysis.expertCourtStance]);useEffect(()=>{if(caseData.liability===localAnalysis)return;setLocalAnalysis(caseData.liability);},[caseData.liability,localAnalysis]);useEffect(()=>{updateCaseData(prev=>{if(!prev)return prev;if(prev.liability===localAnalysis)return prev;return _objectSpread(_objectSpread({},prev),{},{liability:localAnalysis});});},[localAnalysis,updateCaseData]);useEffect(()=>{if(!evidenceOpen||evidenceInitialized)return;let cancelled=false;const loadDocuments=async()=>{setMedicalListLoading(true);setMedicalError(null);try{const docs=await listKnowledgeDocuments({docType:'chapter',limit:10});if(!cancelled){var _docs$0$id,_docs$;setMedicalDocs(docs);setSelectedMedicalId((_docs$0$id=(_docs$=docs[0])===null||_docs$===void 0?void 0:_docs$.id)!==null&&_docs$0$id!==void 0?_docs$0$id:'');setEvidenceInitialized(true);}}catch(error){console.error(error);if(!cancelled){setMedicalError('טעינת ניתוחים רפואיים נכשלה.');}}finally{if(!cancelled){setMedicalListLoading(false);}}};loadDocuments();return()=>{cancelled=true;};},[evidenceOpen,evidenceInitialized]);useEffect(()=>{if(!evidenceOpen||!selectedMedicalId){setMedicalDetail(null);return;}let cancelled=false;setMedicalDetailLoading(true);setMedicalError(null);const loadDetail=async()=>{try{const doc=await getKnowledgeDocument(selectedMedicalId);if(!cancelled){setMedicalDetail(doc);}}catch(error){console.error(error);if(!cancelled){setMedicalError('טעינת המסמך הרפואי נכשלה.');setMedicalDetail(null);}}finally{if(!cancelled){setMedicalDetailLoading(false);}}};loadDetail();return()=>{cancelled=true;};},[evidenceOpen,selectedMedicalId]);const refreshEvidenceDetail=useCallback(async()=>{if(!selectedMedicalId)return;try{const doc=await getKnowledgeDocument(selectedMedicalId);setMedicalDetail(doc);}catch(error){console.error(error);setMedicalError('טעינת המסמך הרפואי נכשלה.');}},[selectedMedicalId]);const requiresHumanExpert=medicalDetail===null||medicalDetail===void 0?void 0:(_medicalDetail$flags=medicalDetail.flags)===null||_medicalDetail$flags===void 0?void 0:_medicalDetail$flags.some(flag=>flag.code==='HUMAN_EXPERT_REQUIRED');const hasAssertionConflict=Boolean(medicalDetail===null||medicalDetail===void 0?void 0:(_medicalDetail$claims=medicalDetail.claims)===null||_medicalDetail$claims===void 0?void 0:_medicalDetail$claims.some(claim=>claim.assertionType==='FACT'))&&Boolean(medicalDetail===null||medicalDetail===void 0?void 0:(_medicalDetail$flags2=medicalDetail.flags)===null||_medicalDetail$flags2===void 0?void 0:_medicalDetail$flags2.some(flag=>flag.severity==='critical'));return/*#__PURE__*/_jsxs(\"div\",{className:\"flex relative\",children:[/*#__PURE__*/_jsx(SmartAssistant,{isOpen:assistantOpen,onClose:()=>setAssistantOpen(false),contextQuery:\"\",onImportPrecedent:()=>{},onImportRule:()=>{}}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 space-y-8 pb-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-shell\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-accent\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card-head\",children:/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Scale,{className:\"w-5 h-5 text-gold\"}),\" \\u05E0\\u05D9\\u05EA\\u05D5\\u05D7 \\u05D7\\u05D1\\u05D5\\u05EA\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-underline\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-card border border-pearl bg-pearl/40 p-4 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-4xl font-bold text-navy\",dir:\"ltr\",children:[localAnalysis.probability,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-slate-light\",children:\"\\u05E1\\u05D9\\u05DB\\u05D5\\u05D9 \\u05DC\\u05EA\\u05D1\\u05D9\\u05E2\\u05D4\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-4 border-t border-pearl/60\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-outline w-full justify-between px-4 py-3\",onClick:()=>setEvidenceOpen(prev=>!prev),\"aria-expanded\":evidenceOpen,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Medical Evidence\"}),/*#__PURE__*/_jsx(\"span\",{children:evidenceOpen?'הסתר':'הצג'})]}),(requiresHumanExpert||hasAssertionConflict)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 state-block state-block--error text-sm\",children:[/*#__PURE__*/_jsx(AlertTriangle,{className:\"state-block__icon\",\"aria-hidden\":\"true\"}),/*#__PURE__*/_jsx(\"p\",{className:\"state-block__title\",children:requiresHumanExpert?'נדרש מומחה אנושי':'זוהתה סתירה בין הטענות לדגלים'}),/*#__PURE__*/_jsx(\"p\",{className:\"state-block__description\",children:requiresHumanExpert?'קיים דגל HUMAN_EXPERT_REQUIRED בתיק. מומלץ לערב מומחה רפואי לפני המשך טיפול.':'יש דגלים קריטיים לצד טענות המסומנות כעובדה. ודא את הממצאים לפני הסתמכות.'})]}),evidenceOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 space-y-4\",children:[medicalError&&/*#__PURE__*/_jsxs(\"div\",{className:\"state-block state-block--error text-sm\",children:[/*#__PURE__*/_jsx(AlertTriangle,{className:\"state-block__icon\",\"aria-hidden\":\"true\"}),/*#__PURE__*/_jsx(\"p\",{className:\"state-block__title\",children:\"\\u05D8\\u05E2\\u05D9\\u05E0\\u05EA \\u05D4\\u05DE\\u05E1\\u05DE\\u05DA \\u05E0\\u05DB\\u05E9\\u05DC\\u05D4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"state-block__description\",children:medicalError})]}),medicalListLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"loader-inline\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"loader-inline__icon\",\"aria-hidden\":\"true\"}),\"\\u05D8\\u05D5\\u05E2\\u05DF \\u05DE\\u05E1\\u05DE\\u05DB\\u05D9\\u05DD \\u05E8\\u05E4\\u05D5\\u05D0\\u05D9\\u05D9\\u05DD...\"]}),!medicalListLoading&&medicalDocs.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"state-block text-sm\",children:[/*#__PURE__*/_jsx(Book,{className:\"state-block__icon\",\"aria-hidden\":\"true\"}),/*#__PURE__*/_jsx(\"p\",{className:\"state-block__title\",children:\"\\u05D0\\u05D9\\u05DF \\u05DE\\u05E1\\u05DE\\u05DB\\u05D9\\u05DD \\u05E8\\u05E4\\u05D5\\u05D0\\u05D9\\u05D9\\u05DD \\u05D6\\u05DE\\u05D9\\u05E0\\u05D9\\u05DD\"}),/*#__PURE__*/_jsx(\"p\",{className:\"state-block__description\",children:\"\\u05D9\\u05D9\\u05D1\\u05D0 \\u05D0\\u05D5 \\u05D1\\u05D7\\u05E8 \\u05DE\\u05E1\\u05DE\\u05DA \\u05E8\\u05E4\\u05D5\\u05D0\\u05D9 \\u05DB\\u05D3\\u05D9 \\u05DC\\u05E6\\u05E4\\u05D5\\u05EA \\u05D1\\u05E0\\u05D9\\u05EA\\u05D5\\u05D7.\"})]}),medicalDocs.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-slate-light\",children:\"\\u05D1\\u05D7\\u05E8 \\u05DE\\u05E1\\u05DE\\u05DA\"}),/*#__PURE__*/_jsx(\"select\",{className:\"mt-1 w-full rounded-card border border-pearl bg-white p-2 text-sm focus:border-gold\",value:selectedMedicalId,onChange:e=>setSelectedMedicalId(e.target.value),disabled:medicalListLoading,children:medicalDocs.map(doc=>/*#__PURE__*/_jsx(\"option\",{value:doc.id,children:doc.title},doc.id))})]}),medicalDetailLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"loader-inline\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"loader-inline__icon\",\"aria-hidden\":\"true\"}),\"\\u05D8\\u05D5\\u05E2\\u05DF \\u05E0\\u05D9\\u05EA\\u05D5\\u05D7 \\u05E8\\u05E4\\u05D5\\u05D0\\u05D9...\"]}),medicalDetail&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(QualityBadge,{score:medicalDetail.score,label:\"\\u05DE\\u05D3\\u05D3 \\u05D0\\u05D9\\u05DB\\u05D5\\u05EA \\u05E8\\u05E4\\u05D5\\u05D0\\u05D9\\u05EA\"}),/*#__PURE__*/_jsx(MedicalQualityBox,{score:medicalDetail.medicalQualityScore,findings:(_medicalDetail$qualit=medicalDetail.qualityFindings)!==null&&_medicalDetail$qualit!==void 0?_medicalDetail$qualit:[],reasoningFindings:(_medicalDetail$reason=medicalDetail.reasoningFindings)!==null&&_medicalDetail$reason!==void 0?_medicalDetail$reason:[]}),/*#__PURE__*/_jsx(KnowledgeFlags,{flags:medicalDetail.flags||[]}),/*#__PURE__*/_jsx(KnowledgeClaimsPanel,{claims:medicalDetail.claims||[],limit:5}),/*#__PURE__*/_jsx(MedicalTimeline,{events:medicalDetail.timeline||[]}),/*#__PURE__*/_jsx(LiteraturePanel,{knowledgeId:medicalDetail.id,resources:(_medicalDetail$litera=medicalDetail.literatureResources)!==null&&_medicalDetail$litera!==void 0?_medicalDetail$litera:[],onRefresh:refreshEvidenceDetail})]}),/*#__PURE__*/_jsx(LegalDisclaimer,{})]})]})]})]})})]});};export default LiabilityStep;","map":{"version":3,"names":["React","useState","useEffect","useCallback","calculateLiabilityScore","Scale","Loader2","AlertTriangle","Book","LegalDisclaimer","SmartAssistant","listKnowledgeDocuments","getKnowledgeDocument","QualityBadge","KnowledgeFlags","KnowledgeClaimsPanel","MedicalTimeline","MedicalQualityBox","LiteraturePanel","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LiabilityStep","_ref","_medicalDetail$flags","_medicalDetail$claims","_medicalDetail$flags2","_medicalDetail$qualit","_medicalDetail$reason","_medicalDetail$litera","caseData","updateCaseData","localAnalysis","setLocalAnalysis","liability","assistantOpen","setAssistantOpen","evidenceOpen","setEvidenceOpen","evidenceInitialized","setEvidenceInitialized","medicalDocs","setMedicalDocs","selectedMedicalId","setSelectedMedicalId","medicalDetail","setMedicalDetail","medicalListLoading","setMedicalListLoading","medicalDetailLoading","setMedicalDetailLoading","medicalError","setMedicalError","result","aggravatingFactors","mitigatingFactors","medicalRecordQuality","expertCourtStance","prev","_objectSpread","probability","probabilityRange","range","uncertainty","cancelled","loadDocuments","docs","docType","limit","_docs$0$id","_docs$","id","error","console","loadDetail","doc","refreshEvidenceDetail","requiresHumanExpert","flags","some","flag","code","hasAssertionConflict","Boolean","claims","claim","assertionType","severity","className","children","isOpen","onClose","contextQuery","onImportPrecedent","onImportRule","dir","type","onClick","length","value","onChange","e","target","disabled","map","title","score","label","medicalQualityScore","findings","qualityFindings","reasoningFindings","events","timeline","knowledgeId","resources","literatureResources","onRefresh"],"sources":["C:/Office-Apps/LexMedical-App/src/components/LiabilityStep.tsx"],"sourcesContent":["import React, { useState, useEffect, Dispatch, SetStateAction, useCallback } from 'react';\nimport {\n  CaseData,\n  LiabilityAnalysis,\n  KnowledgeDocumentSummary,\n  KnowledgeDocumentDetail,\n} from '../types';\nimport { calculateLiabilityScore } from '../services/calculations';\nimport { Scale, Loader2, AlertTriangle, Book } from 'lucide-react';\nimport LegalDisclaimer from './LegalDisclaimer';\nimport SmartAssistant from './SmartAssistant';\nimport { listKnowledgeDocuments, getKnowledgeDocument } from '../services/knowledgeApi';\nimport QualityBadge from './QualityBadge';\nimport KnowledgeFlags from './KnowledgeFlags';\nimport KnowledgeClaimsPanel from './KnowledgeClaimsPanel';\nimport MedicalTimeline from './MedicalTimeline';\nimport MedicalQualityBox from './MedicalQualityBox';\nimport LiteraturePanel from './LiteraturePanel';\n\ninterface Props {\n  caseData: CaseData;\n  updateCaseData: Dispatch<SetStateAction<CaseData | null>>;\n}\n\nconst LiabilityStep: React.FC<Props> = ({ caseData, updateCaseData }) => {\n  const [localAnalysis, setLocalAnalysis] = useState<LiabilityAnalysis>(caseData.liability);\n  const [assistantOpen, setAssistantOpen] = useState(false);\n  const [evidenceOpen, setEvidenceOpen] = useState(false);\n  const [evidenceInitialized, setEvidenceInitialized] = useState(false);\n  const [medicalDocs, setMedicalDocs] = useState<KnowledgeDocumentSummary[]>([]);\n  const [selectedMedicalId, setSelectedMedicalId] = useState<string>('');\n  const [medicalDetail, setMedicalDetail] = useState<KnowledgeDocumentDetail | null>(null);\n  const [medicalListLoading, setMedicalListLoading] = useState(false);\n  const [medicalDetailLoading, setMedicalDetailLoading] = useState(false);\n  const [medicalError, setMedicalError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const result = calculateLiabilityScore(\n      50,\n      localAnalysis.aggravatingFactors,\n      localAnalysis.mitigatingFactors,\n      localAnalysis.medicalRecordQuality,\n      localAnalysis.expertCourtStance\n    );\n    setLocalAnalysis((prev: LiabilityAnalysis) => ({\n      ...prev,\n      probability: result.probability,\n      probabilityRange: result.range,\n      uncertainty: result.uncertainty,\n    }));\n  }, [localAnalysis.aggravatingFactors, localAnalysis.mitigatingFactors, localAnalysis.medicalRecordQuality, localAnalysis.expertCourtStance]);\n\n  useEffect(() => {\n    if (caseData.liability === localAnalysis) return;\n    setLocalAnalysis(caseData.liability);\n  }, [caseData.liability, localAnalysis]);\n\n  useEffect(() => {\n    updateCaseData((prev) => {\n      if (!prev) return prev;\n      if (prev.liability === localAnalysis) return prev;\n      return { ...prev, liability: localAnalysis };\n    });\n  }, [localAnalysis, updateCaseData]);\n\n  useEffect(() => {\n    if (!evidenceOpen || evidenceInitialized) return;\n    let cancelled = false;\n    const loadDocuments = async () => {\n      setMedicalListLoading(true);\n      setMedicalError(null);\n      try {\n        const docs = await listKnowledgeDocuments({ docType: 'chapter', limit: 10 });\n        if (!cancelled) {\n          setMedicalDocs(docs);\n          setSelectedMedicalId(docs[0]?.id ?? '');\n          setEvidenceInitialized(true);\n        }\n      } catch (error) {\n        console.error(error);\n        if (!cancelled) {\n          setMedicalError('טעינת ניתוחים רפואיים נכשלה.');\n        }\n      } finally {\n        if (!cancelled) {\n          setMedicalListLoading(false);\n        }\n      }\n    };\n    loadDocuments();\n    return () => {\n      cancelled = true;\n    };\n  }, [evidenceOpen, evidenceInitialized]);\n\n  useEffect(() => {\n    if (!evidenceOpen || !selectedMedicalId) {\n      setMedicalDetail(null);\n      return;\n    }\n    let cancelled = false;\n    setMedicalDetailLoading(true);\n    setMedicalError(null);\n    const loadDetail = async () => {\n      try {\n        const doc = await getKnowledgeDocument(selectedMedicalId);\n        if (!cancelled) {\n          setMedicalDetail(doc);\n        }\n      } catch (error) {\n        console.error(error);\n        if (!cancelled) {\n          setMedicalError('טעינת המסמך הרפואי נכשלה.');\n          setMedicalDetail(null);\n        }\n      } finally {\n        if (!cancelled) {\n          setMedicalDetailLoading(false);\n        }\n      }\n    };\n    loadDetail();\n    return () => {\n      cancelled = true;\n    };\n  }, [evidenceOpen, selectedMedicalId]);\n\n  const refreshEvidenceDetail = useCallback(async () => {\n    if (!selectedMedicalId) return;\n    try {\n      const doc = await getKnowledgeDocument(selectedMedicalId);\n      setMedicalDetail(doc);\n    } catch (error) {\n      console.error(error);\n      setMedicalError('טעינת המסמך הרפואי נכשלה.');\n    }\n  }, [selectedMedicalId]);\n\n  const requiresHumanExpert = medicalDetail?.flags?.some((flag) => flag.code === 'HUMAN_EXPERT_REQUIRED');\n  const hasAssertionConflict =\n    Boolean(medicalDetail?.claims?.some((claim) => claim.assertionType === 'FACT')) &&\n    Boolean(medicalDetail?.flags?.some((flag) => flag.severity === 'critical'));\n\n  return (\n    <div className=\"flex relative\">\n      <SmartAssistant\n        isOpen={assistantOpen}\n        onClose={() => setAssistantOpen(false)}\n        contextQuery=\"\"\n        onImportPrecedent={() => {}}\n        onImportRule={() => {}}\n      />\n      <div className=\"flex-1 space-y-8 pb-12\">\n        <div className=\"card-shell\">\n          <div className=\"card-accent\" />\n          <div className=\"card-head\">\n            <h2 className=\"text-xl font-bold flex items-center gap-2\">\n              <Scale className=\"w-5 h-5 text-gold\" /> ניתוח חבות\n            </h2>\n          </div>\n          <div className=\"card-underline\" />\n          <div className=\"card-body space-y-6\">\n            <div className=\"rounded-card border border-pearl bg-pearl/40 p-4 text-center\">\n              <div className=\"text-4xl font-bold text-navy\" dir=\"ltr\">\n                {localAnalysis.probability}%\n              </div>\n              <div className=\"text-sm text-slate-light\">סיכוי לתביעה</div>\n            </div>\n            <div className=\"pt-4 border-t border-pearl/60\">\n              <button\n                type=\"button\"\n                className=\"btn-outline w-full justify-between px-4 py-3\"\n                onClick={() => setEvidenceOpen((prev) => !prev)}\n                aria-expanded={evidenceOpen}\n              >\n                <span>Medical Evidence</span>\n                <span>{evidenceOpen ? 'הסתר' : 'הצג'}</span>\n              </button>\n            {(requiresHumanExpert || hasAssertionConflict) && (\n              <div className=\"mt-4 state-block state-block--error text-sm\">\n                <AlertTriangle className=\"state-block__icon\" aria-hidden=\"true\" />\n                <p className=\"state-block__title\">\n                  {requiresHumanExpert ? 'נדרש מומחה אנושי' : 'זוהתה סתירה בין הטענות לדגלים'}\n                </p>\n                <p className=\"state-block__description\">\n                  {requiresHumanExpert\n                    ? 'קיים דגל HUMAN_EXPERT_REQUIRED בתיק. מומלץ לערב מומחה רפואי לפני המשך טיפול.'\n                    : 'יש דגלים קריטיים לצד טענות המסומנות כעובדה. ודא את הממצאים לפני הסתמכות.'}\n                </p>\n              </div>\n            )}\n              {evidenceOpen && (\n                <div className=\"mt-4 space-y-4\">\n                  {medicalError && (\n                    <div className=\"state-block state-block--error text-sm\">\n                      <AlertTriangle className=\"state-block__icon\" aria-hidden=\"true\" />\n                      <p className=\"state-block__title\">טעינת המסמך נכשלה</p>\n                      <p className=\"state-block__description\">{medicalError}</p>\n                    </div>\n                  )}\n                  {medicalListLoading && (\n                    <div className=\"loader-inline\">\n                      <Loader2 className=\"loader-inline__icon\" aria-hidden=\"true\" />\n                      טוען מסמכים רפואיים...\n                    </div>\n                  )}\n                  {!medicalListLoading && medicalDocs.length === 0 && (\n                    <div className=\"state-block text-sm\">\n                      <Book className=\"state-block__icon\" aria-hidden=\"true\" />\n                      <p className=\"state-block__title\">אין מסמכים רפואיים זמינים</p>\n                      <p className=\"state-block__description\">ייבא או בחר מסמך רפואי כדי לצפות בניתוח.</p>\n                    </div>\n                  )}\n                  {medicalDocs.length > 0 && (\n                    <div>\n                      <label className=\"text-xs font-semibold text-slate-light\">בחר מסמך</label>\n                      <select\n                        className=\"mt-1 w-full rounded-card border border-pearl bg-white p-2 text-sm focus:border-gold\"\n                        value={selectedMedicalId}\n                        onChange={(e) => setSelectedMedicalId(e.target.value)}\n                        disabled={medicalListLoading}\n                      >\n                        {medicalDocs.map((doc) => (\n                          <option key={doc.id} value={doc.id}>\n                            {doc.title}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  )}\n                  {medicalDetailLoading && (\n                    <div className=\"loader-inline\">\n                      <Loader2 className=\"loader-inline__icon\" aria-hidden=\"true\" />\n                      טוען ניתוח רפואי...\n                    </div>\n                  )}\n                  {medicalDetail && (\n                    <>\n                      <QualityBadge score={medicalDetail.score} label=\"מדד איכות רפואית\" />\n                      <MedicalQualityBox\n                        score={medicalDetail.medicalQualityScore}\n                        findings={medicalDetail.qualityFindings ?? []}\n                        reasoningFindings={medicalDetail.reasoningFindings ?? []}\n                      />\n                      <KnowledgeFlags flags={medicalDetail.flags || []} />\n                      <KnowledgeClaimsPanel claims={medicalDetail.claims || []} limit={5} />\n                      <MedicalTimeline events={medicalDetail.timeline || []} />\n                      <LiteraturePanel\n                        knowledgeId={medicalDetail.id}\n                        resources={medicalDetail.literatureResources ?? []}\n                        onRefresh={refreshEvidenceDetail}\n                      />\n                    </>\n                  )}\n                <LegalDisclaimer />\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default LiabilityStep;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}