{"ast":null,"code":"const shouldBlockKey = (storageName, action, key) => {\n  if (!key.startsWith('lexmedical_')) {\n    return false;\n  }\n  const message = `[storage-guard] ${storageName}.${action} blocked for PHI key \"${key}\". Data stays server-side only.`;\n  if (process.env.NODE_ENV !== 'production') {\n    throw new Error(message);\n  }\n  // eslint-disable-next-line no-console\n  console.warn(message);\n  return true;\n};\nconst warnClear = storageName => {\n  const message = `[storage-guard] ${storageName}.clear() called. PHI is never stored locally.`;\n  // eslint-disable-next-line no-console\n  console.warn(message);\n};\nconst patchStorage = (storageName, storage) => {\n  if (!storage) return;\n  const originalSet = storage.setItem.bind(storage);\n  storage.setItem = (key, value) => {\n    if (shouldBlockKey(storageName, 'setItem', key)) {\n      return;\n    }\n    originalSet(key, value);\n  };\n  const originalGet = storage.getItem.bind(storage);\n  storage.getItem = key => {\n    if (shouldBlockKey(storageName, 'getItem', key)) {\n      return null;\n    }\n    return originalGet(key);\n  };\n  const originalRemove = storage.removeItem.bind(storage);\n  storage.removeItem = key => {\n    if (shouldBlockKey(storageName, 'removeItem', key)) {\n      return;\n    }\n    originalRemove(key);\n  };\n  const originalClear = storage.clear.bind(storage);\n  storage.clear = () => {\n    warnClear(storageName);\n    originalClear();\n  };\n};\nexport const applyStorageGuard = () => {\n  if (typeof window === 'undefined') {\n    return;\n  }\n  patchStorage('localStorage', window.localStorage);\n  patchStorage('sessionStorage', window.sessionStorage);\n};","map":{"version":3,"names":["shouldBlockKey","storageName","action","key","startsWith","message","process","env","NODE_ENV","Error","console","warn","warnClear","patchStorage","storage","originalSet","setItem","bind","value","originalGet","getItem","originalRemove","removeItem","originalClear","clear","applyStorageGuard","window","localStorage","sessionStorage"],"sources":["C:/Office-Apps/LexMedical-App/src/utils/storageGuard.ts"],"sourcesContent":["const shouldBlockKey = (storageName: string, action: string, key: string): boolean => {\r\n  if (!key.startsWith('lexmedical_')) {\r\n    return false;\r\n  }\r\n  const message = `[storage-guard] ${storageName}.${action} blocked for PHI key \"${key}\". Data stays server-side only.`;\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    throw new Error(message);\r\n  }\r\n  // eslint-disable-next-line no-console\r\n  console.warn(message);\r\n  return true;\r\n};\r\n\r\nconst warnClear = (storageName: string): void => {\r\n  const message = `[storage-guard] ${storageName}.clear() called. PHI is never stored locally.`;\r\n  // eslint-disable-next-line no-console\r\n  console.warn(message);\r\n};\r\n\r\nconst patchStorage = (storageName: 'localStorage' | 'sessionStorage', storage: Storage | undefined): void => {\r\n  if (!storage) return;\r\n\r\n  const originalSet = storage.setItem.bind(storage);\r\n  storage.setItem = (key: string, value: string) => {\r\n    if (shouldBlockKey(storageName, 'setItem', key)) {\r\n      return;\r\n    }\r\n    originalSet(key, value);\r\n  };\r\n\r\n  const originalGet = storage.getItem.bind(storage);\r\n  storage.getItem = (key: string) => {\r\n    if (shouldBlockKey(storageName, 'getItem', key)) {\r\n      return null;\r\n    }\r\n    return originalGet(key);\r\n  };\r\n\r\n  const originalRemove = storage.removeItem.bind(storage);\r\n  storage.removeItem = (key: string) => {\r\n    if (shouldBlockKey(storageName, 'removeItem', key)) {\r\n      return;\r\n    }\r\n    originalRemove(key);\r\n  };\r\n\r\n  const originalClear = storage.clear.bind(storage);\r\n  storage.clear = () => {\r\n    warnClear(storageName);\r\n    originalClear();\r\n  };\r\n};\r\n\r\nexport const applyStorageGuard = (): void => {\r\n  if (typeof window === 'undefined') {\r\n    return;\r\n  }\r\n  patchStorage('localStorage', window.localStorage);\r\n  patchStorage('sessionStorage', window.sessionStorage);\r\n};\r\n\r\n"],"mappings":"AAAA,MAAMA,cAAc,GAAGA,CAACC,WAAmB,EAAEC,MAAc,EAAEC,GAAW,KAAc;EACpF,IAAI,CAACA,GAAG,CAACC,UAAU,CAAC,aAAa,CAAC,EAAE;IAClC,OAAO,KAAK;EACd;EACA,MAAMC,OAAO,GAAG,mBAAmBJ,WAAW,IAAIC,MAAM,yBAAyBC,GAAG,iCAAiC;EACrH,IAAIG,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY,EAAE;IACzC,MAAM,IAAIC,KAAK,CAACJ,OAAO,CAAC;EAC1B;EACA;EACAK,OAAO,CAACC,IAAI,CAACN,OAAO,CAAC;EACrB,OAAO,IAAI;AACb,CAAC;AAED,MAAMO,SAAS,GAAIX,WAAmB,IAAW;EAC/C,MAAMI,OAAO,GAAG,mBAAmBJ,WAAW,+CAA+C;EAC7F;EACAS,OAAO,CAACC,IAAI,CAACN,OAAO,CAAC;AACvB,CAAC;AAED,MAAMQ,YAAY,GAAGA,CAACZ,WAA8C,EAAEa,OAA4B,KAAW;EAC3G,IAAI,CAACA,OAAO,EAAE;EAEd,MAAMC,WAAW,GAAGD,OAAO,CAACE,OAAO,CAACC,IAAI,CAACH,OAAO,CAAC;EACjDA,OAAO,CAACE,OAAO,GAAG,CAACb,GAAW,EAAEe,KAAa,KAAK;IAChD,IAAIlB,cAAc,CAACC,WAAW,EAAE,SAAS,EAAEE,GAAG,CAAC,EAAE;MAC/C;IACF;IACAY,WAAW,CAACZ,GAAG,EAAEe,KAAK,CAAC;EACzB,CAAC;EAED,MAAMC,WAAW,GAAGL,OAAO,CAACM,OAAO,CAACH,IAAI,CAACH,OAAO,CAAC;EACjDA,OAAO,CAACM,OAAO,GAAIjB,GAAW,IAAK;IACjC,IAAIH,cAAc,CAACC,WAAW,EAAE,SAAS,EAAEE,GAAG,CAAC,EAAE;MAC/C,OAAO,IAAI;IACb;IACA,OAAOgB,WAAW,CAAChB,GAAG,CAAC;EACzB,CAAC;EAED,MAAMkB,cAAc,GAAGP,OAAO,CAACQ,UAAU,CAACL,IAAI,CAACH,OAAO,CAAC;EACvDA,OAAO,CAACQ,UAAU,GAAInB,GAAW,IAAK;IACpC,IAAIH,cAAc,CAACC,WAAW,EAAE,YAAY,EAAEE,GAAG,CAAC,EAAE;MAClD;IACF;IACAkB,cAAc,CAAClB,GAAG,CAAC;EACrB,CAAC;EAED,MAAMoB,aAAa,GAAGT,OAAO,CAACU,KAAK,CAACP,IAAI,CAACH,OAAO,CAAC;EACjDA,OAAO,CAACU,KAAK,GAAG,MAAM;IACpBZ,SAAS,CAACX,WAAW,CAAC;IACtBsB,aAAa,CAAC,CAAC;EACjB,CAAC;AACH,CAAC;AAED,OAAO,MAAME,iBAAiB,GAAGA,CAAA,KAAY;EAC3C,IAAI,OAAOC,MAAM,KAAK,WAAW,EAAE;IACjC;EACF;EACAb,YAAY,CAAC,cAAc,EAAEa,MAAM,CAACC,YAAY,CAAC;EACjDd,YAAY,CAAC,gBAAgB,EAAEa,MAAM,CAACE,cAAc,CAAC;AACvD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}